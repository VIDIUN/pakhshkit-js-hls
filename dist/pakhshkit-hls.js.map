{"version":3,"sources":["./hls/webpack/universalModuleDefinition","./hls/pakhshkit-hls.js","./hls/webpack/bootstrap 12f2222cf2f47807dfac","./hls/external {\"commonjs\":\"pakhshkit-js\",\"commonjs2\":\"pakhshkit-js\",\"amd\":\"pakhshkit-js\",\"root\":[\"pakhshkit\",\"core\"]}","./hls/external {\"commonjs\":\"hls.js\",\"commonjs2\":\"hls.js\",\"amd\":\"hls.js\",\"root\":\"Hls\"}","./hls/./index.js","./hls/./hls-adapter.js","./hls/./default-config.json","./hls/./errors.js","./hls/./jsonp-ploader.js"],"names":["root","factory","exports","module","require","define","amd","this","__WEBPACK_EXTERNAL_MODULE_0__","__WEBPACK_EXTERNAL_MODULE_1__","modules","__webpack_require__","moduleId","installedModules","i","l","call","m","c","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","n","__esModule","object","property","prototype","hasOwnProperty","p","s","value","NAME","VERSION","undefined","_pakhshkitJs","_hlsAdapter","_hlsAdapter2","obj","default","isSupported","registerMediaSourceAdapter","_interopRequireDefault","_classCallCheck","instance","Constructor","TypeError","_possibleConstructorReturn","self","ReferenceError","_inherits","subClass","superClass","create","constructor","writable","setPrototypeOf","__proto__","_get","receiver","Function","desc","getOwnPropertyDescriptor","parent","getPrototypeOf","_createClass","defineProperties","target","props","length","descriptor","key","protoProps","staticProps","_hls","_hls2","_defaultConfig","_defaultConfig2","_errors","_jsonpPloader","_jsonpPloader2","HlsAdapter","_BaseMediaSourceAdapt","videoElement","source","config","_logger","debug","version","_this","_triedReloadWithRedirect","_startTime","_config","Utils","mergeDeep","forceRedirectExternalStreams","hlsConfig","_addBindings","adapterConfig","hasPropertyPath","playback","options","html5","hls","sources","redirectExternalStreamsHandler","redirectExternalStreamsTimeout","getPropertyPath","startPosition","startTime","mimeType","canHlsPlayType","_hlsMimeTypes","includes","toLowerCase","toString","warn","isHlsSupported","_this2","on","Events","ERROR","e","data","_onError","MANIFEST_LOADED","_onManifestLoaded","bind","LEVEL_SWITCHED","_onLevelSwitched","AUDIO_TRACK_SWITCHED","_onAudioTrackSwitched","_this3","_loadPromise","Promise","resolve","_resolveLoad","_loadInternal","_onLoadedMetadataCallback","_onLoadedMetadata","_videoElement","addEventListener","EventType","LOADED_METADATA","_sourceObj","url","loadSource","attachMedia","_trigger","ABR_MODE_CHANGED","mode","isAdaptiveBitrateEnabled","_reset","_removeLoadedMetadataListener","tracks","_playerTracks","removeEventListener","_this4","then","_removeBindings","detachMedia","destroy","audioTracks","_parseAudioTracks","videoTracks","_parseVideoTracks","levels","textTracks","_parseTextTracks","subtitleTracks","concat","hlsAudioTracks","settings","id","active","audioTrack","label","language","lang","index","push","AudioTrack","hlsVideoTracks","startLevel","bandwidth","bitrate","width","height","VideoTrack","hlsTextTracks","kind","type","TextTrack","videoTrack","currentLevel","textTrack","_disableAllTextTracks","_onTrackChanged","nextLevel","autoLevelEnabled","level","nextAutoLevel","nextLoadLevel","details","liveEdge","liveSyncPosition","liveSyncDuration","duration","liveSyncDurationCount","_getLevelDetails","targetduration","currentTime","_getLiveEdge","live","autoStartLoad","startLoad","_parseTracks","event","find","track","_handleWaitingUponAudioTrackSwitch","_this5","Env","browser","timeUpdateListener","PLAYING","TIME_UPDATE","vidTextTracks","errorType","errorDetails","fatal","error","ErrorTypes","NETWORK_ERROR","ErrorDetails","MANIFEST_LOAD_ERROR","MANIFEST_LOAD_TIMEOUT","Error","Severity","CRITICAL","Category","NETWORK","Code","HTTP_ERROR","_reloadWithDirectManifest","MEDIA_ERROR","_handleMediaError","RECOVERABLE","MEDIA","HLS_FATAL_MEDIA_ERROR","PLAYER","severity","_ref","HlsJsErrorMap","category","code","now","performance","recover","_checkTimeDeltaHasPassed","_recoverDecodingErrorDate","recoverDecodingErrorDelay","_recoverDecodingError","_recoverSwapAudioCodecDate","recoverSwapAudioCodecDelay","_recoverSwapAudioCodec","delay","recoverMediaError","swapAudioCodec","off","isLive","fragments","fragLength","start","end","maxLatency","liveMaxLatencyDuration","liveMaxLatencyDurationCount","Math","max","maxFragLookUpTolerance","BaseMediaSourceAdapter","getLogger","fragLoadingMaxRetry","maxMaxBufferLength","_defineProperty","_HlsJsErrorMap","MANIFEST","TIMEOUT","MANIFEST_PARSING_ERROR","HLSJS_CANNOT_PARSE","LEVEL_LOAD_ERROR","LEVEL_LOAD_TIMEOUT","LEVEL_SWITCH_ERROR","BITRATE_SWITCH_ISSUE","FRAG_LOAD_ERROR","FRAG_LOOP_LOADING_ERROR","FRAG_LOAD_TIMEOUT","FRAG_PARSING_ERROR","HLS_FRAG_PARSING_ERROR","BUFFER_APPEND_ERROR","HLS_BUFFER_APPEND_ISSUE","BUFFER_APPENDING_ERROR","HLS_BUFFER_APPENDING_ISSUE","BUFFER_STALLED_ERROR","HLS_BUFFER_STALLED_ERROR","pLoader","_Hlsjs$DefaultConfig$","loadOrig","load","callback","context","callbacks","Http","jsonp","timeout","uri","catch","DefaultConfig","loader"],"mappings":"CAAA,SAAAA,EAAAC,GACA,gBAAAC,UAAA,gBAAAC,QACAA,OAAAD,QAAAD,EAAAG,QAAA,gBAAAA,QAAA,WACA,kBAAAC,gBAAAC,IACAD,QAAA,yBAAAJ,GACA,gBAAAC,SACAA,QAAA,IAAAD,EAAAG,QAAA,gBAAAA,QAAA,YAEAJ,EAAA,UAAAA,EAAA,cAA6CA,EAAA,cAAAC,EAAAD,EAAA,eAAAA,EAAA,OAC5CO,KAAA,SAAAC,EAAAC,GACD,MCAgB,UAAUC,GCN1B,QAAAC,GAAAC,GAGA,GAAAC,EAAAD,GACA,MAAAC,GAAAD,GAAAV,OAGA,IAAAC,GAAAU,EAAAD,IACAE,EAAAF,EACAG,GAAA,EACAb,WAUA,OANAQ,GAAAE,GAAAI,KAAAb,EAAAD,QAAAC,IAAAD,QAAAS,GAGAR,EAAAY,GAAA,EAGAZ,EAAAD,QAvBA,GAAAW,KA4DA,OAhCAF,GAAAM,EAAAP,EAGAC,EAAAO,EAAAL,EAGAF,EAAAQ,EAAA,SAAAjB,EAAAkB,EAAAC,GACAV,EAAAW,EAAApB,EAAAkB,IACAG,OAAAC,eAAAtB,EAAAkB,GACAK,cAAA,EACAC,YAAA,EACAC,IAAAN,KAMAV,EAAAiB,EAAA,SAAAzB,GACA,GAAAkB,GAAAlB,KAAA0B,WACA,WAA2B,MAAA1B,GAAA,SAC3B,WAAiC,MAAAA,GAEjC,OADAQ,GAAAQ,EAAAE,EAAA,IAAAA,GACAA,GAIAV,EAAAW,EAAA,SAAAQ,EAAAC,GAAsD,MAAAR,QAAAS,UAAAC,eAAAjB,KAAAc,EAAAC,IAGtDpB,EAAAuB,EAAA,GAGAvB,IAAAwB,EAAA,KDgBM,SAAUhC,EAAQD,GE7ExBC,EAAAD,QAAAM,GFmFM,SAAUL,EAAQD,GGnFxBC,EAAAD,QAAAO,GHyFM,SAAUN,EAAQD,EAASS,GAEjC,YAGAY,QAAOC,eAAetB,EAAS,cAC7BkC,OAAO,IAETlC,EAAQmC,KAAOnC,EAAQoC,YAAUC,EIhGjC,IAAAC,GAAA7B,EAAA,GACA8B,EAAA9B,EAAA,GJqGI+B,EAEJ,SAAgCC,GAAO,MAAOA,IAAOA,EAAId,WAAac,GAAQC,QAASD,IAF7CF,EAI1CvC,GAAQ0C,QAAUF,EAAaE,QAC/B1C,EIpGuBoC,QAAf,QJqGRpC,EIrG4CmC,KAAZ,mBAG5BK,EAAAE,QAAWC,gBACb,EAAAL,EAAAM,4BAAAJ,EAAAE,UJ2GI,SAAUzC,EAAQD,EAASS,GAEjC,YA2BA,SAASoC,GAAuBJ,GAAO,MAAOA,IAAOA,EAAId,WAAac,GAAQC,QAASD,GAEvF,QAASK,GAAgBC,EAAUC,GAAe,KAAMD,YAAoBC,IAAgB,KAAM,IAAIC,WAAU,qCAEhH,QAASC,GAA2BC,EAAMrC,GAAQ,IAAKqC,EAAQ,KAAM,IAAIC,gBAAe,4DAAgE,QAAOtC,GAAyB,gBAATA,IAAqC,kBAATA,GAA8BqC,EAAPrC,EAElO,QAASuC,GAAUC,EAAUC,GAAc,GAA0B,kBAAfA,IAA4C,OAAfA,EAAuB,KAAM,IAAIN,WAAU,iEAAoEM,GAAeD,GAASxB,UAAYT,OAAOmC,OAAOD,GAAcA,EAAWzB,WAAa2B,aAAevB,MAAOoB,EAAU9B,YAAY,EAAOkC,UAAU,EAAMnC,cAAc,KAAegC,IAAYlC,OAAOsC,eAAiBtC,OAAOsC,eAAeL,EAAUC,GAAcD,EAASM,UAAYL,GA9BjelC,OAAOC,eAAetB,EAAS,cAC7BkC,OAAO,GAGT,IAAI2B,GAAO,QAASpC,GAAIG,EAAQC,EAAUiC,GAA2B,OAAXlC,IAAiBA,EAASmC,SAASjC,UAAW,IAAIkC,GAAO3C,OAAO4C,yBAAyBrC,EAAQC,EAAW,QAAaQ,KAAT2B,EAAoB,CAAE,GAAIE,GAAS7C,OAAO8C,eAAevC,EAAS,OAAe,QAAXsC,MAAmB,GAAkCzC,EAAIyC,EAAQrC,EAAUiC,GAAoB,GAAI,SAAWE,GAAQ,MAAOA,GAAK9B,KAAgB,IAAIf,GAAS6C,EAAKvC,GAAK,QAAeY,KAAXlB,EAA4C,MAAOA,GAAOL,KAAKgD,IAExdM,EAAe,WAAc,QAASC,GAAiBC,EAAQC,GAAS,IAAK,GAAI3D,GAAI,EAAGA,EAAI2D,EAAMC,OAAQ5D,IAAK,CAAE,GAAI6D,GAAaF,EAAM3D,EAAI6D,GAAWjD,WAAaiD,EAAWjD,aAAc,EAAOiD,EAAWlD,cAAe,EAAU,SAAWkD,KAAYA,EAAWf,UAAW,GAAMrC,OAAOC,eAAegD,EAAQG,EAAWC,IAAKD,IAAiB,MAAO,UAAUzB,EAAa2B,EAAYC,GAAiJ,MAA9HD,IAAYN,EAAiBrB,EAAYlB,UAAW6C,GAAiBC,GAAaP,EAAiBrB,EAAa4B,GAAqB5B,MKjIhiB6B,EAAApE,EAAA,GLqIIqE,EAAQjC,EAAuBgC,GKpInCE,EAAAtE,EAAA,GLwIIuE,EAAkBnC,EAAuBkC,GKvI7CE,EAAAxE,EAAA,GACA6B,EAAA7B,EAAA,GAWAyE,EAAAzE,EAAA,GLmII0E,EAAiBtC,EAAuBqC,GK7HvBE,EL2IJ,SAAUC,GKqBzB,QAAAD,GAAYE,EAAgCC,EAA6BC,GAAgB1C,EAAAzC,KAAA+E,GACvFA,EAAWK,QAAQC,MAAM,kCAAoCZ,EAAApC,QAAMiD,QADoB,IAAAC,GAAA1C,EAAA7C,MAAA+E,EAAAxB,WAAAvC,OAAA8C,eAAAiB,IAAAtE,KAAAT,KAEjFiF,EAAcC,EAAQC,GAF2D,OAAAI,GAxGzFC,0BAAoC,EAwGqDD,EAlFzFE,WAAsB,EAqFpBF,EAAKG,QAAUzD,EAAA0D,MAAM3E,OAAO4E,aAAcL,EAAKG,QAAhCf,EAAAtC,SACXkD,EAAKG,QAAQG,+BACfN,EAAKG,QAAQI,UAAb,QAAAhB,EAAAzC,SAEFkD,EAAKf,KAAO,GAAAC,GAAApC,QAAUkD,EAAKG,QAAQI,WACnCP,EAAKQ,eARkFR,EL2zBzF,MA/0BAvC,GAAU+B,EAAYC,GAEtBjB,EAAagB,EAAY,OACvBV,IAAK,gBAqDLxC,MAAO,SKpGYoD,EAAgCC,EAA6BC,GAChF,GAAIa,KAIJ,IAHI/D,EAAA0D,MAAM3E,OAAOiF,gBAAgBd,EAAQ,gCACvCa,EAAcF,UAAYX,EAAOe,SAASC,QAAQC,MAAMC,KAEtDpE,EAAA0D,MAAM3E,OAAOiF,gBAAgBd,EAAQ,mBAAoB,CAC3D,GAAMgB,GAAUhB,EAAOmB,QAAQH,OAC/BH,GAAcH,6BAA+BM,EAAQN,6BACrDG,EAAcO,+BAAiCJ,EAAQI,+BACvDP,EAAcQ,+BAAiCL,EAAQK,+BACvD1B,EAAAzC,QAAQkE,+BAAiCP,EAAcO,+BACvDzB,EAAAzC,QAAQmE,+BAAiCR,EAAcQ,+BAEzD,GAAIvE,EAAA0D,MAAM3E,OAAOiF,gBAAgBd,EAAQ,sBAAuB,CAC5ClD,EAAA0D,MAAM3E,OAAOyF,gBAAgBtB,EAAQ,uBACtC,IACfa,EAAcF,UAAUY,cAAgBvB,EAAOe,SAASS,WAG5D,MAAO,IAAI3G,MAAKiF,EAAcC,EAAQc,MLoJtC3B,IAAK,cACLxC,MAAO,SK3IU+E,GACjB,GAAIC,GAAsC,gBAAbD,IAAyB7B,EAAW+B,cAAcC,SAASH,EAASI,cAEjG,OADAjC,GAAWK,QAAQC,MAAM,mCAAqCuB,EAAW,OAASC,EAAeI,YAC1FJ,KLsJPxC,IAAK,aACLxC,MAAO,WK5IP,MADAkD,GAAWK,QAAQ8B,KAAK,+BACjB,KLyJP7C,IAAK,cACLxC,MAAO,WKhJP,GAAIsF,GAAiB1C,EAAApC,QAAMC,aAE3B,OADAyC,GAAWK,QAAQC,MAAM,eAAiB8B,GACnCA,MLwLTpD,EAAagB,IACXV,IAAK,eACLxC,MAAO,WKhKY,GAAAuF,GAAApH,IACnBA,MAAKwE,KAAK6C,GAAG5C,EAAApC,QAAMiF,OAAOC,MAAO,SAACC,EAAGC,GAAJ,MAAaL,GAAKM,SAASD,KAC5DzH,KAAKwE,KAAK6C,GAAG5C,EAAApC,QAAMiF,OAAOK,gBAAiB3H,KAAK4H,kBAAkBC,KAAK7H,OACvEA,KAAKwE,KAAK6C,GAAG5C,EAAApC,QAAMiF,OAAOQ,eAAgB9H,KAAK+H,iBAAiBF,KAAK7H,OACrEA,KAAKwE,KAAK6C,GAAG5C,EAAApC,QAAMiF,OAAOU,qBAAsBhI,KAAKiI,sBAAsBJ,KAAK7H,ULgLhFqE,IAAK,OACLxC,MAAO,SKvKJ8E,GAAqC,GAAAuB,GAAAlI,IAQxC,OAPKA,MAAKmI,eACRnI,KAAKyF,WAAakB,EAClB3G,KAAKmI,aAAe,GAAIC,SAAQ,SAACC,GAC/BH,EAAKI,aAAeD,EACpBH,EAAKK,mBAGFvI,KAAKmI,gBLoLZ9D,IAAK,gBACLxC,MAAO,WK3KP7B,KAAKwI,0BAA4BxI,KAAKyI,kBAAkBZ,KAAK7H,MAC7DA,KAAK0I,cAAcC,iBAAiB1G,EAAA2G,UAAUC,gBAAiB7I,KAAKwI,2BAChExI,KAAK8I,YAAc9I,KAAK8I,WAAWC,MACrC/I,KAAKwE,KAAKwE,WAAWhJ,KAAK8I,WAAWC,KACrC/I,KAAKwE,KAAKyE,YAAYjJ,KAAK0I,eAC3B1I,KAAKkJ,SAASjH,EAAA2G,UAAUO,kBAAmBC,KAAMpJ,KAAKqJ,2BAA6B,OAAS,eLwL9FhF,IAAK,4BACLxC,MAAO,WK7KP7B,KAAKwF,0BAA2B,EAEhCxF,KAAKsJ,SAELtJ,KAAK0F,QAAQI,UAAb,QAAAhB,EAAAzC,QACArC,KAAKwE,KAAO,GAAAC,GAAApC,QAAUrC,KAAK0F,QAAQI,WACnC9F,KAAK+F,eACL/F,KAAKuI,mBLyLLlE,IAAK,oBACLxC,MAAO,WKjLP7B,KAAKuJ,gCACLvJ,KAAKsI,cAAckB,OAAQxJ,KAAKyJ,mBL4LhCpF,IAAK,gCACLxC,MAAO,WKpLH7B,KAAKwI,4BACPxI,KAAK0I,cAAcgB,oBAAoBzH,EAAA2G,UAAUC,gBAAiB7I,KAAKwI,2BACvExI,KAAKwI,0BAA4B,SLiMnCnE,IAAK,UACLxC,MAAO,WKxLa,GAAA8H,GAAA3J,IACpB,OAAOwD,GAAAuB,EAAAtD,UAAA8B,WAAAvC,OAAA8C,eAAAiB,EAAAtD,WAAA,UAAAzB,MAAAS,KAAAT,MAAgB4J,KAAK,WAC1B7E,EAAWK,QAAQC,MAAM,WACzBsE,EAAKxB,aAAe,KACpBwB,EAAKF,iBACLE,EAAKL,cLqMPjF,IAAK,SACLxC,MAAO,WK5LP7B,KAAK6J,kBACL7J,KAAKwE,KAAKsF,cACV9J,KAAKwE,KAAKuF,aLuMV1F,IAAK,eACLxC,MAAO,WK/LP,GAAMmI,GAAchK,KAAKiK,kBAAkBjK,KAAKwE,KAAKwF,iBAC/CE,EAAclK,KAAKmK,kBAAkBnK,KAAKwE,KAAK4F,YAC/CC,EAAarK,KAAKsK,iBAAiBtK,KAAKwE,KAAK+F,mBACnD,OAAOP,GAAYQ,OAAON,GAAaM,OAAOH,ML2M9ChG,IAAK,oBACLxC,MAAO,SKnMS4I,GAEhB,IAAK,GADDT,MACKzJ,EAAI,EAAGA,EAAIkK,EAAetG,OAAQ5D,IAAK,CAE9C,GAAImK,IACFC,GAAIF,EAAelK,GAAGoK,GACtBC,OAAQ5K,KAAKwE,KAAKqG,aAAeJ,EAAelK,GAAGoK,GACnDG,MAAOL,EAAelK,GAAGM,KACzBkK,SAAUN,EAAelK,GAAGyK,KAC5BC,MAAO1K,EAETyJ,GAAYkB,KAAK,GAAAjJ,GAAAkJ,WAAeT,IAElC,MAAOV,ML8MP3F,IAAK,oBACLxC,MAAO,SKtMSuJ,GAEhB,IAAK,GADDlB,MACK3J,EAAI,EAAGA,EAAI6K,EAAejH,OAAQ5D,IAAK,CAE9C,GAAImK,IACFE,OAAQ5K,KAAKwE,KAAK6G,aAAe9K,EACjC+K,UAAWF,EAAe7K,GAAGgL,QAC7BC,MAAOJ,EAAe7K,GAAGiL,MACzBC,OAAQL,EAAe7K,GAAGkL,OAC1BV,SAAU,GACVE,MAAO1K,EAET2J,GAAYgB,KAAK,GAAAjJ,GAAAyJ,WAAehB,IAElC,MAAOR,MLiNP7F,IAAK,mBACLxC,MAAO,SKzMQ8J,GAEf,IAAK,GADDtB,MACK9J,EAAI,EAAGA,EAAIoL,EAAcxH,OAAQ5D,IAAK,CAE7C,GAAImK,IACFC,GAAIgB,EAAcpL,GAAGoK,GACrBC,OAAQe,EAAcpL,GAAG8B,QACzByI,MAAOa,EAAcpL,GAAGM,KACxB+K,KAAMD,EAAcpL,GAAGsL,KAAK7E,cAC5B+D,SAAUY,EAAcpL,GAAGyK,KAC3BC,MAAO1K,EAET8J,GAAWa,KAAK,GAAAjJ,GAAA6J,UAAcpB,IAEhC,MAAOL,MLqNPhG,IAAK,mBACLxC,MAAO,SK5MQgJ,GACXA,4BAAqCA,EAAWD,QAAU5K,KAAKwE,KAAKwF,cACtEhK,KAAKwE,KAAKqG,WAAaA,EAAWF,OLyNpCtG,IAAK,mBACLxC,MAAO,SK/MQkK,GACXA,6BAAsCA,EAAWnB,QAAU5K,KAAKqJ,6BAA+BrJ,KAAKwE,KAAK4F,SACvGpK,KAAKqJ,4BACPrJ,KAAKkJ,SAASjH,EAAA2G,UAAUO,kBAAmBC,KAAM,WAEnDpJ,KAAKwE,KAAKwH,aAAeD,EAAWd,UL4NtC5G,IAAK,kBACLxC,MAAO,SKlNOoK,GACVA,2BAAmCA,EAAUrB,QAAU5K,KAAK0I,cAAc2B,aAC5ErK,KAAKkM,wBACLlM,KAAK0I,cAAc2B,WAAW4B,EAAUhB,OAAO7B,KAAO,SACtDrE,EAAWK,QAAQC,MAAM,qBAAsB4G,GAC/CjM,KAAKmM,gBAAgBF,OL6NvB5H,IAAK,gBACLxC,MAAO,WKpNP7B,KAAKkM,2BLgOL7H,IAAK,wBACLxC,MAAO,WKvNF7B,KAAKqJ,6BACRrJ,KAAKkJ,SAASjH,EAAA2G,UAAUO,kBAAmBC,KAAM,SACjDpJ,KAAKwE,KAAK4H,WAAa,MLoOzB/H,IAAK,2BACLxC,MAAO,WK1NP,MAAO7B,MAAKwE,KAAK6H,oBLsOjBhI,IAAK,mBACLxC,MAAO,WK7NP,GAAMyK,GAAQtM,KAAKwE,KAAK4F,OAAOpK,KAAKwE,KAAKwH,eAAiBhM,KAAKwE,KAAK4F,OAAOpK,KAAKwE,KAAK4H,YAAcpM,KAAKwE,KAAK4F,OAAOpK,KAAKwE,KAAK+H,gBAAkBvM,KAAKwE,KAAK4F,OAAOpK,KAAKwE,KAAKgI,cAC3K,OAAOF,IAASA,EAAMG,QAAUH,EAAMG,cLwOtCpI,IAAK,eACLxC,MAAO,WKhOP,IACE,GAAI6K,SAQJ,OANEA,GADE1M,KAAKwE,KAAKmI,iBACD3M,KAAKwE,KAAKmI,iBACZ3M,KAAKwE,KAAKW,OAAOyH,iBACf5M,KAAK0I,cAAcmE,SAAW7M,KAAKwE,KAAKW,OAAOyH,iBAE/C5M,KAAK0I,cAAcmE,SAAW7M,KAAKwE,KAAKW,OAAO2H,sBAAwB9M,KAAK+M,mBAAmBC,eAErGN,EAAW,EAAIA,EAAW1M,KAAK0I,cAAcmE,SACpD,MAAOrF,GAEP,MADAzC,GAAWK,QAAQC,MAAM,uDAClBrF,KAAK0I,cAAcmE,aL6O5BxI,IAAK,iBACLxC,MAAO,WKnOP,IACE7B,KAAK0I,cAAcuE,YAAcjN,KAAKkN,eACtC,MAAO1F,GACP,WLgPFnD,IAAK,SACLxC,MAAO,WKtOP,IACE,QAAU7B,KAAK+M,mBAAmBI,KAClC,MAAO3F,GACP,OAAO,MLmPTnD,IAAK,oBACLxC,MAAO,WKzOPkD,EAAWK,QAAQC,MAAM,2CACpBrF,KAAKwE,KAAKW,OAAOiI,eACpBpN,KAAKwE,KAAK6I,UAAUrN,KAAKyF,YAE3BzF,KAAKyJ,cAAgBzJ,KAAKsN,kBLuP1BjJ,IAAK,mBACLxC,MAAO,SK7OQ0L,EAAe9F,GAC9B,GAAIsE,GAAa/L,KAAKyJ,cAAc+D,KAAK,SAACC,GACxC,MAAQA,4BAA+BA,EAAMxC,QAAUxD,EAAK6E,OAE9DvH,GAAWK,QAAQC,MAAM,sBAAuB0G,GAChD/L,KAAKmM,gBAAgBJ,ML0PrB1H,IAAK,wBACLxC,MAAO,SKhPa0L,EAAe9F,GACnC,GAAIoD,GAAa7K,KAAKyJ,cAAc+D,KAAK,SAACC,GACxC,MAAQA,4BAA+BA,EAAM9C,KAAOlD,EAAKkD,IAE3D5F,GAAWK,QAAQC,MAAM,sBAAuBwF,GAChD7K,KAAKmM,gBAAgBtB,GACrB7K,KAAK0N,wCL4PLrJ,IAAK,qCACLxC,MAAO,WKnPkC,GAAA8L,GAAA3N,IAEzC,KAD0B,KAAM,QACX+G,SAAS9E,EAAA2L,IAAIC,QAAQhN,MAAO,CAC/C,GAAMiN,GAAqB,QAArBA,KACJH,EAAKzE,SAASjH,EAAA2G,UAAUmF,SACxBJ,EAAKjF,cAAcgB,oBAAoBzH,EAAA2G,UAAUoF,YAAaF,GAEhE9N,MAAK0I,cAAcC,iBAAiB1G,EAAA2G,UAAUoF,YAAaF,OLgQ7DzJ,IAAK,wBACLxC,MAAO,WKtPP,IAAK,GADDoM,GAAgBjO,KAAK0I,cAAc2B,WAC9B9J,EAAI,EAAGA,EAAI0N,EAAc9J,OAAQ5D,IACxC0N,EAAc1N,GAAG6I,KAAO,cLoQ1B/E,IAAK,WACLxC,MAAO,SK3PA4F,GACP,GAAMyG,GAAYzG,EAAKoE,KACjBsC,EAAe1G,EAAKgF,OAE1B,IADmBhF,EAAK2G,MACR,CACd,GAAIC,SACJ,QAAQH,GACN,IAAKzJ,GAAApC,QAAMiM,WAAWC,gBACf9J,EAAApC,QAAMmM,aAAaC,oBAAqBhK,EAAApC,QAAMmM,aAAaE,uBAAuB3H,SAASoH,IAC7FnO,KAAKwF,0BAA6BxF,KAAK0F,QAAQG,6BAGhDwI,EAAQ,GAAApM,GAAA0M,MACN1M,EAAA0M,MAAMC,SAASC,SACf5M,EAAA0M,MAAMG,SAASC,QACf9M,EAAA0M,MAAMK,KAAKC,WACXd,GANFnO,KAAKkP,2BAQP,MACF,KAAKzK,GAAApC,QAAMiM,WAAWa,YAElBd,EADErO,KAAKoP,oBACC,GAAAnN,GAAA0M,MACN1M,EAAA0M,MAAMC,SAASS,YACfpN,EAAA0M,MAAMG,SAASQ,MACfrN,EAAA0M,MAAMK,KAAKO,sBACXpB,GAEM,GAAAlM,GAAA0M,MACN1M,EAAA0M,MAAMC,SAASC,SACf5M,EAAA0M,MAAMG,SAASQ,MACfrN,EAAA0M,MAAMK,KAAKO,sBACXpB,EAEJ,MACF,SACEE,EAAQ,GAAApM,GAAA0M,MACN1M,EAAA0M,MAAMC,SAASC,SACf5M,EAAA0M,MAAMG,SAASU,OACfvN,EAAA0M,MAAMK,KAAKO,sBACXpB,GAGNnO,KAAKkJ,SAASjH,EAAA2G,UAAUrB,MAAO8G,GAC3BA,GAASA,EAAMoB,WAAaxN,EAAA0M,MAAMC,SAASC,UAC7C7O,KAAK+J,cAEF,IAAA2F,GACsC9K,EAAA+K,cAAcxB,KAAkByB,SAAU,EAAGC,KAAM,GAAvFD,EADFF,EACEE,SAAUC,EADZH,EACYG,IACjB9K,GAAWK,QAAQ8B,KAAK,GAAAjF,GAAA0M,MACtB1M,EAAA0M,MAAMC,SAASS,YACfO,EACAC,EACA1B,QLoPJ9J,IAAK,oBACLxC,MAAO,WK3OP,GAAMiO,GAAcC,YAAYD,MAC5BE,GAAU,CAWd,OAVIhQ,MAAKiQ,yBAAyBH,EAAK9P,KAAKkQ,0BAA2BlQ,KAAK0F,QAAQyK,2BAClFnQ,KAAKoQ,wBAEDpQ,KAAKiQ,yBAAyBH,EAAK9P,KAAKqQ,2BAA4BrQ,KAAK0F,QAAQ4K,4BACnFtQ,KAAKuQ,0BAELP,GAAU,EACVjL,EAAWK,QAAQiJ,MAAM,qDAGtB2B,KLyPP3L,IAAK,2BACLxC,MAAO,SK/OgBiO,EAAalG,EAAc4G,GAClD,OAAS5G,GAASkG,EAAMlG,EAAQ4G,KLyPhCnM,IAAK,wBACLxC,MAAO,WKjPP7B,KAAKkQ,0BAA4BH,YAAYD,MAC7C/K,EAAWK,QAAQ8B,KAAK,8BACxBlH,KAAKwE,KAAKiM,uBL4PVpM,IAAK,yBACLxC,MAAO,WKpPP7B,KAAKqQ,2BAA6BN,YAAYD,MAC9C/K,EAAWK,QAAQ8B,KAAK,mDACxBlH,KAAKwE,KAAKkM,iBACV1Q,KAAKwE,KAAKiM,uBL+PVpM,IAAK,kBACLxC,MAAO,WKvPP7B,KAAKwE,KAAKmM,IAAIlM,EAAApC,QAAMiF,OAAOC,MAAOvH,KAAK0H,UACvC1H,KAAKwE,KAAKmM,IAAIlM,EAAApC,QAAMiF,OAAOQ,eAAgB9H,KAAK+H,kBAChD/H,KAAKwE,KAAKmM,IAAIlM,EAAApC,QAAMiF,OAAOU,qBAAsBhI,KAAKiI,uBACtDjI,KAAKuJ,mCLkQLlF,IAAK,0BACLxC,MAAO,WK1PP,IAAI7B,KAAK4Q,SAiBP,MAAO,EAhBP,KACE,GAAMpE,GAAgBxM,KAAKwE,KAAK4F,OAAOpK,KAAKwE,KAAKgI,eAC/CC,EAAUD,EAAcC,QACxBoE,EAAYpE,EAAQoE,UACpBC,EAAaD,EAAU1M,OACvB4M,EAAQF,EAAU,GAAGE,MAAQF,EAAU,GAAGhE,SAC1CmE,EAAMH,EAAUC,EAAa,GAAGC,MAAQF,EAAUC,EAAa,GAAGjE,SAClEoE,MAAyDjP,KAA5ChC,KAAKwE,KAAKW,OAAO+L,uBAAuClR,KAAKwE,KAAKW,OAAO+L,uBAAyBlR,KAAKwE,KAAKW,OAAOgM,4BAA8B1E,EAAQO,cAExK,OADiBoE,MAAKC,IAAIN,EAAQ/Q,KAAKwE,KAAKW,OAAOmM,uBAAwBN,EAAMC,GAGnF,MAAOzJ,GAEL,MADAzC,GAAWK,QAAQC,MAAM,yCAClB,OLkQNN,GACP9C,EAAasP,uBK59BMxM,GAOZ4F,GAAa,aAPD5F,EAcZK,QAAUnD,EAAAsP,uBAAuBC,UAAUzM,EAAW4F,IAd1C5F,EAqBZ+B,eACL,wBACA,gCACA,gBACA,kBACA,kBACA,gBACA,uBLq8BJnH,EAAQ0C,QKj+Ba0C,GLq+Bf,SAAUnF,EAAQD,GM1/BxBC,EAAAD,SACAwQ,0BAAA,IACAG,2BAAA,IACAxK,WACA2L,oBAAA,EACAC,mBAAA,MNkgCM,SAAU9R,EAAQD,EAASS,GAEjC,YAkBA,SAASuR,GAAgBvP,EAAKiC,EAAKxC,GAAiK,MAApJwC,KAAOjC,GAAOpB,OAAOC,eAAemB,EAAKiC,GAAOxC,MAAOA,EAAOV,YAAY,EAAMD,cAAc,EAAMmC,UAAU,IAAkBjB,EAAIiC,GAAOxC,EAAgBO,EAf3MpB,OAAOC,eAAetB,EAAS,cAC7BkC,OAAO,IAETlC,EAAQgQ,kBAAgB3N,EAExB,IAAI4P,GOhhCJpN,EAAApE,EAAA,GPohCIqE,EAIJ,SAAgCrC,GAAO,MAAOA,IAAOA,EAAId,WAAac,GAAQC,QAASD,IAJpDoC,GOnhCnCvC,EAAA7B,EAAA,GAKMuP,YACHlL,EAAApC,QAAMmM,aAAaC,qBAClBmB,SAAU3N,EAAA0M,MAAMG,SAAS+C,SACzBhC,KAAM5N,EAAA0M,MAAMK,KAAKC,aAHf0C,EAAAC,EAKHnN,EAAApC,QAAMmM,aAAaE,uBAClBkB,SAAU3N,EAAA0M,MAAMG,SAAS+C,SACzBhC,KAAM5N,EAAA0M,MAAMK,KAAK8C,UAPfH,EAAAC,EASHnN,EAAApC,QAAMmM,aAAauD,wBAClBnC,SAAU3N,EAAA0M,MAAMG,SAAS+C,SACzBhC,KAAM5N,EAAA0M,MAAMK,KAAKgD,qBAXfL,EAAAC,EAaHnN,EAAApC,QAAMmM,aAAayD,kBAClBrC,SAAU3N,EAAA0M,MAAMG,SAASC,QACzBc,KAAM5N,EAAA0M,MAAMK,KAAKC,aAff0C,EAAAC,EAiBHnN,EAAApC,QAAMmM,aAAa0D,oBAClBtC,SAAU3N,EAAA0M,MAAMG,SAASC,QACzBc,KAAM5N,EAAA0M,MAAMK,KAAK8C,UAnBfH,EAAAC,EAqBHnN,EAAApC,QAAMmM,aAAa2D,oBAClBvC,SAAU3N,EAAA0M,MAAMG,SAASU,OACzBK,KAAM5N,EAAA0M,MAAMK,KAAKoD,uBAvBfT,EAAAC,EAyBHnN,EAAApC,QAAMmM,aAAa6D,iBAClBzC,SAAU3N,EAAA0M,MAAMG,SAASC,QACzBc,KAAM5N,EAAA0M,MAAMK,KAAKC,aA3Bf0C,EAAAC,EA6BHnN,EAAApC,QAAMmM,aAAa8D,yBAClB1C,SAAU3N,EAAA0M,MAAMG,SAASC,QACzBc,KAAM5N,EAAA0M,MAAMK,KAAKC,aA/Bf0C,EAAAC,EAiCHnN,EAAApC,QAAMmM,aAAa+D,mBAClB3C,SAAU3N,EAAA0M,MAAMG,SAASC,QACzBc,KAAM5N,EAAA0M,MAAMK,KAAK8C,UAnCfH,EAAAC,EAqCHnN,EAAApC,QAAMmM,aAAagE,oBAClB5C,SAAU3N,EAAA0M,MAAMG,SAASQ,MACzBO,KAAM5N,EAAA0M,MAAMK,KAAKyD,yBAvCfd,EAAAC,EAyCHnN,EAAApC,QAAMmM,aAAakE,qBAClB9C,SAAU3N,EAAA0M,MAAMG,SAASQ,MACzBO,KAAM5N,EAAA0M,MAAMK,KAAK2D,0BA3CfhB,EAAAC,EA6CHnN,EAAApC,QAAMmM,aAAaoE,wBAClBhD,SAAU3N,EAAA0M,MAAMG,SAASQ,MACzBO,KAAM5N,EAAA0M,MAAMK,KAAK6D,6BA/CflB,EAAAC,EAiDHnN,EAAApC,QAAMmM,aAAasE,sBAClBlD,SAAU3N,EAAA0M,MAAMG,SAASQ,MACzBO,KAAM5N,EAAA0M,MAAMK,KAAK+D,2BAnDfnB,EP+jCNjS,GOxgCQgQ,iBP4gCF,SAAU/P,EAAQD,EAASS,GAEjC,YAeA,SAASqC,GAAgBC,EAAUC,GAAe,KAAMD,YAAoBC,IAAgB,KAAM,IAAIC,WAAU,qCAEhH,QAASC,GAA2BC,EAAMrC,GAAQ,IAAKqC,EAAQ,KAAM,IAAIC,gBAAe,4DAAgE,QAAOtC,GAAyB,gBAATA,IAAqC,kBAATA,GAA8BqC,EAAPrC,EAElO,QAASuC,GAAUC,EAAUC,GAAc,GAA0B,kBAAfA,IAA4C,OAAfA,EAAuB,KAAM,IAAIN,WAAU,iEAAoEM,GAAeD,GAASxB,UAAYT,OAAOmC,OAAOD,GAAcA,EAAWzB,WAAa2B,aAAevB,MAAOoB,EAAU9B,YAAY,EAAOkC,UAAU,EAAMnC,cAAc,KAAegC,IAAYlC,OAAOsC,eAAiBtC,OAAOsC,eAAeL,EAAUC,GAAcD,EAASM,UAAYL,GAhBjelC,OAAOC,eAAetB,EAAS,cAC7BkC,OAAO,GQ/kCT,IAAAI,GAAA7B,EAAA,GACAoE,EAAApE,EAAA,GRqlCIqE,EAEJ,SAAgCrC,GAAO,MAAOA,IAAOA,EAAId,WAAac,GAAQC,QAASD,IAFpDoC,GQ9kCdwO,ER6lCP,SAAUC,GQhlCtB,QAAAD,GAAY7N,GAAgB1C,EAAAzC,KAAAgT,EAAA,IAAAzN,GAAA1C,EAAA7C,MAAAgT,EAAAzP,WAAAvC,OAAA8C,eAAAkP,IAAAvS,KAAAT,KACpBmF,IACA+N,EAAW3N,EAAK4N,KAAKtL,KAAVtC,GACX6N,EAAWJ,EAAQzM,8BAHC,OAI1BhB,GAAK4N,KAAO,SAACE,EAASlO,EAAQmO,GAC5B,GAAMvK,GAAMsK,EAAQtK,GACC,cAAjBsK,EAAQxH,KACV5J,EAAA0D,MAAM4N,KAAKC,MAAMzK,EAAKqK,GACpBK,QAAST,EAAQxM,iCAChBoD,KAAK,SAAA8J,GACNL,EAAQtK,IAAM2K,EACdR,EAASG,EAASlO,EAAQmO,KACzBK,MAAM,iBAAMT,GAASG,EAASlO,EAAQmO,KAEzCJ,EAASG,EAASlO,EAAQmO,IAdJ/N,ERunC5B,MAtCAvC,GAAUgQ,EAASC,GAsCZD,GQpoC4BvO,EAAApC,QAAMuR,cAAcC,OAApCb,GAOZzM,+BAA2C,SAAAmN,GAAA,MAAOA,IRooC3D/T,EAAQ0C,QQ3oCa2Q","file":"pakhshkit-hls.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"pakhshkit-js\"), require(\"hls.js\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"pakhshkit-js\", \"hls.js\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"hls\"] = factory(require(\"pakhshkit-js\"), require(\"hls.js\"));\n\telse\n\t\troot[\"pakhshkit\"] = root[\"pakhshkit\"] || {}, root[\"pakhshkit\"][\"hls\"] = factory(root[\"pakhshkit\"][\"core\"], root[\"Hls\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_0__, __WEBPACK_EXTERNAL_MODULE_1__) {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"pakhshkit-js\"), require(\"hls.js\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"pakhshkit-js\", \"hls.js\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"hls\"] = factory(require(\"pakhshkit-js\"), require(\"hls.js\"));\n\telse\n\t\troot[\"pakhshkit\"] = root[\"pakhshkit\"] || {}, root[\"pakhshkit\"][\"hls\"] = factory(root[\"pakhshkit\"][\"core\"], root[\"Hls\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_0__, __WEBPACK_EXTERNAL_MODULE_1__) {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 2);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports) {\n\nmodule.exports = __WEBPACK_EXTERNAL_MODULE_0__;\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports) {\n\nmodule.exports = __WEBPACK_EXTERNAL_MODULE_1__;\n\n/***/ }),\n/* 2 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.NAME = exports.VERSION = undefined;\n\nvar _pakhshkitJs = __webpack_require__(0);\n\nvar _hlsAdapter = __webpack_require__(3);\n\nvar _hlsAdapter2 = _interopRequireDefault(_hlsAdapter);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.default = _hlsAdapter2.default;\nexports.VERSION = \"1.6.2\";\nexports.NAME = \"pakhshkit-js-hls\";\n\n// Register hls adapter to the media source adapter provider.\n\nif (_hlsAdapter2.default.isSupported()) {\n  (0, _pakhshkitJs.registerMediaSourceAdapter)(_hlsAdapter2.default);\n}\n\n/***/ }),\n/* 3 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _hls = __webpack_require__(1);\n\nvar _hls2 = _interopRequireDefault(_hls);\n\nvar _defaultConfig = __webpack_require__(4);\n\nvar _defaultConfig2 = _interopRequireDefault(_defaultConfig);\n\nvar _errors = __webpack_require__(5);\n\nvar _pakhshkitJs = __webpack_require__(0);\n\nvar _jsonpPloader = __webpack_require__(6);\n\nvar _jsonpPloader2 = _interopRequireDefault(_jsonpPloader);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\n/**\r\n * Adapter of hls.js lib for hls content.\r\n * @classdesc\r\n */\nvar HlsAdapter = function (_BaseMediaSourceAdapt) {\n  _inherits(HlsAdapter, _BaseMediaSourceAdapt);\n\n  _createClass(HlsAdapter, null, [{\n    key: 'createAdapter',\n\n\n    /**\r\n     * Factory method to create media source adapter.\r\n     * @function createAdapter\r\n     * @param {HTMLVideoElement} videoElement - The video element that the media source adapter work with.\r\n     * @param {PKMediaSourceObject} source - The source Object.\r\n     * @param {Object} config - The player configuration.\r\n     * @returns {IMediaSourceAdapter} - New instance of the run time media source adapter.\r\n     * @static\r\n     */\n\n    /**\r\n     * Reference to _onLoadedMetadata function\r\n     * @member {?Function} - _onLoadedMetadataCallback\r\n     * @type {?Function}\r\n     * @private\r\n     */\n\n\n    /**\r\n     * indicate if external redirect was performed\r\n     * @type {boolean}\r\n     * @private\r\n     */\n\n    /**\r\n     * The hls player instance.\r\n     * @member {any} _hls\r\n     * @private\r\n     */\n\n\n    /**\r\n     * last recover date from decoding error\r\n     * @type {number}\r\n     * @private\r\n     */\n\n\n    /**\r\n     * last recover date from audio swap codec operation\r\n     * @type {number}\r\n     * @private\r\n     */\n\n    /**\r\n     * The adapter logger.\r\n     * @member {any} _logger\r\n     * @static\r\n     * @private\r\n     */\n    value: function createAdapter(videoElement, source, config) {\n      var adapterConfig = {};\n      if (_pakhshkitJs.Utils.Object.hasPropertyPath(config, 'playback.options.html5.hls')) {\n        adapterConfig.hlsConfig = config.playback.options.html5.hls;\n      }\n      if (_pakhshkitJs.Utils.Object.hasPropertyPath(config, 'sources.options')) {\n        var options = config.sources.options;\n        adapterConfig.forceRedirectExternalStreams = options.forceRedirectExternalStreams;\n        adapterConfig.redirectExternalStreamsHandler = options.redirectExternalStreamsHandler;\n        adapterConfig.redirectExternalStreamsTimeout = options.redirectExternalStreamsTimeout;\n        _jsonpPloader2.default.redirectExternalStreamsHandler = adapterConfig.redirectExternalStreamsHandler;\n        _jsonpPloader2.default.redirectExternalStreamsTimeout = adapterConfig.redirectExternalStreamsTimeout;\n      }\n      if (_pakhshkitJs.Utils.Object.hasPropertyPath(config, 'playback.startTime')) {\n        var startTime = _pakhshkitJs.Utils.Object.getPropertyPath(config, 'playback.startTime');\n        if (startTime > -1) {\n          adapterConfig.hlsConfig.startPosition = config.playback.startTime;\n        }\n      }\n      return new this(videoElement, source, adapterConfig);\n    }\n\n    /**\r\n     * Checks if hls adapter can play a given mime type.\r\n     * @function canPlayType\r\n     * @param {string} mimeType - The mime type to check.\r\n     * @returns {boolean} - Whether the hls adapter can play a specific mime type.\r\n     * @static\r\n     */\n\n    /**\r\n     * stream start time in seconds\r\n     * @type {?number}\r\n     * @private\r\n     */\n\n\n    /**\r\n     * The load promise\r\n     * @member {Promise<Object>} - _loadPromise\r\n     * @type {Promise<Object>}\r\n     * @private\r\n     */\n\n\n    /**\r\n     * Reference to the player tracks.\r\n     * @member {Array<Track>} - _playerTracks\r\n     * @type {Array<Track>}\r\n     * @private\r\n     */\n\n    /**\r\n     * The supported mime types by the hls adapter.\r\n     * @member {Array<string>} _hlsMimeType\r\n     * @static\r\n     * @private\r\n     */\n\n    /**\r\n     * The id of the adapter.\r\n     * @member {string} id\r\n     * @static\r\n     * @private\r\n     */\n\n  }, {\n    key: 'canPlayType',\n    value: function canPlayType(mimeType) {\n      var canHlsPlayType = typeof mimeType === 'string' ? HlsAdapter._hlsMimeTypes.includes(mimeType.toLowerCase()) : false;\n      HlsAdapter._logger.debug('canPlayType result for mimeType:' + mimeType + ' is ' + canHlsPlayType.toString());\n      return canHlsPlayType;\n    }\n\n    /**\r\n     * Checks if hls adapter can play a given drm data.\r\n     * For hls.js it always returns false.\r\n     * @returns {boolean} - Whether the hls adapter can play a specific drm data.\r\n     * @static\r\n     */\n\n  }, {\n    key: 'canPlayDrm',\n    value: function canPlayDrm() {\n      HlsAdapter._logger.warn('canPlayDrm result is false');\n      return false;\n    }\n\n    /**\r\n     * Checks if the hls adapter is supported.\r\n     * @function isSupported\r\n     * @returns {boolean} - Whether hls is supported.\r\n     * @static\r\n     */\n\n  }, {\n    key: 'isSupported',\n    value: function isSupported() {\n      var isHlsSupported = _hls2.default.isSupported();\n      HlsAdapter._logger.debug('isSupported:' + isHlsSupported);\n      return isHlsSupported;\n    }\n\n    /**\r\n     * @constructor\r\n     * @param {HTMLVideoElement} videoElement - The video element which will bind to the hls adapter\r\n     * @param {PKMediaSourceObject} source - The source object\r\n     * @param {Object} config - The media source adapter configuration\r\n     */\n\n  }]);\n\n  function HlsAdapter(videoElement, source, config) {\n    _classCallCheck(this, HlsAdapter);\n\n    HlsAdapter._logger.debug('Creating adapter. Hls version: ' + _hls2.default.version);\n\n    var _this = _possibleConstructorReturn(this, (HlsAdapter.__proto__ || Object.getPrototypeOf(HlsAdapter)).call(this, videoElement, source, config));\n\n    _this._triedReloadWithRedirect = false;\n    _this._startTime = 0;\n\n    _this._config = _pakhshkitJs.Utils.Object.mergeDeep({}, _this._config, _defaultConfig2.default);\n    if (_this._config.forceRedirectExternalStreams) {\n      _this._config.hlsConfig['pLoader'] = _jsonpPloader2.default;\n    }\n    _this._hls = new _hls2.default(_this._config.hlsConfig);\n    _this._addBindings();\n    return _this;\n  }\n\n  /**\r\n   * Adds the required bindings with hls.js.\r\n   * @function _addBindings\r\n   * @private\r\n   * @returns {void}\r\n   */\n\n\n  _createClass(HlsAdapter, [{\n    key: '_addBindings',\n    value: function _addBindings() {\n      var _this2 = this;\n\n      this._hls.on(_hls2.default.Events.ERROR, function (e, data) {\n        return _this2._onError(data);\n      });\n      this._hls.on(_hls2.default.Events.MANIFEST_LOADED, this._onManifestLoaded.bind(this));\n      this._hls.on(_hls2.default.Events.LEVEL_SWITCHED, this._onLevelSwitched.bind(this));\n      this._hls.on(_hls2.default.Events.AUDIO_TRACK_SWITCHED, this._onAudioTrackSwitched.bind(this));\n    }\n\n    /**\r\n     * Load the video source\r\n     * @function load\r\n     * @param {number} startTime - Optional time to start the video from.\r\n     * @returns {Promise<Object>} - The loaded data\r\n     * @override\r\n     */\n\n  }, {\n    key: 'load',\n    value: function load(startTime) {\n      var _this3 = this;\n\n      if (!this._loadPromise) {\n        this._startTime = startTime;\n        this._loadPromise = new Promise(function (resolve) {\n          _this3._resolveLoad = resolve;\n          _this3._loadInternal();\n        });\n      }\n      return this._loadPromise;\n    }\n\n    /**\r\n     * Load the video source\r\n     * @function load\r\n     * @returns {void}\r\n     * @private\r\n     */\n\n  }, {\n    key: '_loadInternal',\n    value: function _loadInternal() {\n      this._onLoadedMetadataCallback = this._onLoadedMetadata.bind(this);\n      this._videoElement.addEventListener(_pakhshkitJs.EventType.LOADED_METADATA, this._onLoadedMetadataCallback);\n      if (this._sourceObj && this._sourceObj.url) {\n        this._hls.loadSource(this._sourceObj.url);\n        this._hls.attachMedia(this._videoElement);\n        this._trigger(_pakhshkitJs.EventType.ABR_MODE_CHANGED, { mode: this.isAdaptiveBitrateEnabled() ? 'auto' : 'manual' });\n      }\n    }\n\n    /**\r\n     * Load the video source with installed playlist loader\r\n     * @function _reloadWithDirectManifest\r\n     * @returns {void}\r\n     * @private\r\n     */\n\n  }, {\n    key: '_reloadWithDirectManifest',\n    value: function _reloadWithDirectManifest() {\n      // Mark that we tried once to redirect\n      this._triedReloadWithRedirect = true;\n      // reset hls.js\n      this._reset();\n      // re-init hls.js with the external redirect playlist loader\n      this._config.hlsConfig['pLoader'] = _jsonpPloader2.default;\n      this._hls = new _hls2.default(this._config.hlsConfig);\n      this._addBindings();\n      this._loadInternal();\n    }\n\n    /**\r\n     * Loaded metadata event handler.\r\n     * @private\r\n     * @returns {void}\r\n     */\n\n  }, {\n    key: '_onLoadedMetadata',\n    value: function _onLoadedMetadata() {\n      this._removeLoadedMetadataListener();\n      this._resolveLoad({ tracks: this._playerTracks });\n    }\n\n    /**\r\n     * Remove the loadedmetadata listener\r\n     * @private\r\n     * @returns {void}\r\n     */\n\n  }, {\n    key: '_removeLoadedMetadataListener',\n    value: function _removeLoadedMetadataListener() {\n      if (this._onLoadedMetadataCallback) {\n        this._videoElement.removeEventListener(_pakhshkitJs.EventType.LOADED_METADATA, this._onLoadedMetadataCallback);\n        this._onLoadedMetadataCallback = null;\n      }\n    }\n\n    /**\r\n     * Destroys the hls adapter.\r\n     * @function destroy\r\n     * @override\r\n     * @returns {Promise<*>} - The destroy promise.\r\n     */\n\n  }, {\n    key: 'destroy',\n    value: function destroy() {\n      var _this4 = this;\n\n      return _get(HlsAdapter.prototype.__proto__ || Object.getPrototypeOf(HlsAdapter.prototype), 'destroy', this).call(this).then(function () {\n        HlsAdapter._logger.debug('destroy');\n        _this4._loadPromise = null;\n        _this4._playerTracks = [];\n        _this4._reset();\n      });\n    }\n\n    /**\r\n     * reset hls.js instance and its bindings\r\n     * @private\r\n     * @returns {void}\r\n     */\n\n  }, {\n    key: '_reset',\n    value: function _reset() {\n      this._removeBindings();\n      this._hls.detachMedia();\n      this._hls.destroy();\n    }\n\n    /**\r\n     * Parse the hls tracks into player tracks.\r\n     * @returns {Array<Track>} - The parsed tracks.\r\n     * @private\r\n     */\n\n  }, {\n    key: '_parseTracks',\n    value: function _parseTracks() {\n      var audioTracks = this._parseAudioTracks(this._hls.audioTracks || []);\n      var videoTracks = this._parseVideoTracks(this._hls.levels || []);\n      var textTracks = this._parseTextTracks(this._hls.subtitleTracks || []);\n      return audioTracks.concat(videoTracks).concat(textTracks);\n    }\n\n    /**\r\n     * Parse hls audio tracks into player audio tracks.\r\n     * @param {Array<Object>} hlsAudioTracks - The hls audio tracks.\r\n     * @returns {Array<AudioTrack>} - The parsed audio tracks.\r\n     * @private\r\n     */\n\n  }, {\n    key: '_parseAudioTracks',\n    value: function _parseAudioTracks(hlsAudioTracks) {\n      var audioTracks = [];\n      for (var i = 0; i < hlsAudioTracks.length; i++) {\n        // Create audio tracks\n        var settings = {\n          id: hlsAudioTracks[i].id,\n          active: this._hls.audioTrack === hlsAudioTracks[i].id,\n          label: hlsAudioTracks[i].name,\n          language: hlsAudioTracks[i].lang,\n          index: i\n        };\n        audioTracks.push(new _pakhshkitJs.AudioTrack(settings));\n      }\n      return audioTracks;\n    }\n\n    /**\r\n     * Parse hls video tracks into player video tracks.\r\n     * @param {Array<Object>} hlsVideoTracks - The hls video tracks.\r\n     * @returns {Array<VideoTrack>} - The parsed video tracks.\r\n     * @private\r\n     */\n\n  }, {\n    key: '_parseVideoTracks',\n    value: function _parseVideoTracks(hlsVideoTracks) {\n      var videoTracks = [];\n      for (var i = 0; i < hlsVideoTracks.length; i++) {\n        // Create video tracks\n        var settings = {\n          active: this._hls.startLevel === i,\n          bandwidth: hlsVideoTracks[i].bitrate,\n          width: hlsVideoTracks[i].width,\n          height: hlsVideoTracks[i].height,\n          language: '',\n          index: i\n        };\n        videoTracks.push(new _pakhshkitJs.VideoTrack(settings));\n      }\n      return videoTracks;\n    }\n\n    /**\r\n     * Parse hls text tracks into player text tracks.\r\n     * @param {Array<Object>} hlsTextTracks - The hls text tracks.\r\n     * @returns {Array<TextTrack>} - The parsed text tracks.\r\n     * @private\r\n     */\n\n  }, {\n    key: '_parseTextTracks',\n    value: function _parseTextTracks(hlsTextTracks) {\n      var textTracks = [];\n      for (var i = 0; i < hlsTextTracks.length; i++) {\n        // Create text tracks\n        var settings = {\n          id: hlsTextTracks[i].id,\n          active: hlsTextTracks[i].default,\n          label: hlsTextTracks[i].name,\n          kind: hlsTextTracks[i].type.toLowerCase(),\n          language: hlsTextTracks[i].lang,\n          index: i\n        };\n        textTracks.push(new _pakhshkitJs.TextTrack(settings));\n      }\n      return textTracks;\n    }\n\n    /**\r\n     * Select an audio track.\r\n     * @function selectAudioTrack\r\n     * @param {AudioTrack} audioTrack - the audio track to select.\r\n     * @returns {void}\r\n     * @public\r\n     */\n\n  }, {\n    key: 'selectAudioTrack',\n    value: function selectAudioTrack(audioTrack) {\n      if (audioTrack instanceof _pakhshkitJs.AudioTrack && !audioTrack.active && this._hls.audioTracks) {\n        this._hls.audioTrack = audioTrack.id;\n      }\n    }\n\n    /**\r\n     * Select a video track.\r\n     * @function selectVideoTrack\r\n     * @param {VideoTrack} videoTrack - the track to select.\r\n     * @returns {void}\r\n     * @public\r\n     */\n\n  }, {\n    key: 'selectVideoTrack',\n    value: function selectVideoTrack(videoTrack) {\n      if (videoTrack instanceof _pakhshkitJs.VideoTrack && (!videoTrack.active || this.isAdaptiveBitrateEnabled()) && this._hls.levels) {\n        if (this.isAdaptiveBitrateEnabled()) {\n          this._trigger(_pakhshkitJs.EventType.ABR_MODE_CHANGED, { mode: 'manual' });\n        }\n        this._hls.currentLevel = videoTrack.index;\n      }\n    }\n\n    /**\r\n     * Select a text track.\r\n     * @function selectTextTrack\r\n     * @param {TextTrack} textTrack - the track to select.\r\n     * @returns {void}\r\n     * @public\r\n     */\n\n  }, {\n    key: 'selectTextTrack',\n    value: function selectTextTrack(textTrack) {\n      if (textTrack instanceof _pakhshkitJs.TextTrack && !textTrack.active && this._videoElement.textTracks) {\n        this._disableAllTextTracks();\n        this._videoElement.textTracks[textTrack.index].mode = 'hidden';\n        HlsAdapter._logger.debug('Text track changed', textTrack);\n        this._onTrackChanged(textTrack);\n      }\n    }\n\n    /** Hide the text track\r\n     * @function hideTextTrack\r\n     * @returns {void}\r\n     * @public\r\n     */\n\n  }, {\n    key: 'hideTextTrack',\n    value: function hideTextTrack() {\n      this._disableAllTextTracks();\n    }\n\n    /**\r\n     * Enables adaptive bitrate switching according to hls.js logic.\r\n     * @function enableAdaptiveBitrate\r\n     * @returns {void}\r\n     * @public\r\n     */\n\n  }, {\n    key: 'enableAdaptiveBitrate',\n    value: function enableAdaptiveBitrate() {\n      if (!this.isAdaptiveBitrateEnabled()) {\n        this._trigger(_pakhshkitJs.EventType.ABR_MODE_CHANGED, { mode: 'auto' });\n        this._hls.nextLevel = -1;\n      }\n    }\n\n    /**\r\n     * Checking if adaptive bitrate switching is enabled.\r\n     * @function isAdaptiveBitrateEnabled\r\n     * @returns {boolean} - Whether adaptive bitrate is enabled.\r\n     * @public\r\n     */\n\n  }, {\n    key: 'isAdaptiveBitrateEnabled',\n    value: function isAdaptiveBitrateEnabled() {\n      return this._hls.autoLevelEnabled;\n    }\n\n    /**\r\n     * Returns the details of hls level\r\n     * @function _getLevelDetails\r\n     * @returns {Object} - Level details\r\n     * @private\r\n     */\n\n  }, {\n    key: '_getLevelDetails',\n    value: function _getLevelDetails() {\n      var level = this._hls.levels[this._hls.currentLevel] || this._hls.levels[this._hls.nextLevel] || this._hls.levels[this._hls.nextAutoLevel] || this._hls.levels[this._hls.nextLoadLevel];\n      return level && level.details ? level.details : {};\n    }\n\n    /**\r\n     * Returns the live edge\r\n     * @returns {number} - live edge\r\n     * @private\r\n     */\n\n  }, {\n    key: '_getLiveEdge',\n    value: function _getLiveEdge() {\n      try {\n        var liveEdge = void 0;\n        if (this._hls.liveSyncPosition) {\n          liveEdge = this._hls.liveSyncPosition;\n        } else if (this._hls.config.liveSyncDuration) {\n          liveEdge = this._videoElement.duration - this._hls.config.liveSyncDuration;\n        } else {\n          liveEdge = this._videoElement.duration - this._hls.config.liveSyncDurationCount * this._getLevelDetails().targetduration;\n        }\n        return liveEdge > 0 ? liveEdge : this._videoElement.duration;\n      } catch (e) {\n        HlsAdapter._logger.debug('Live edge calculation failed, fall back to duration');\n        return this._videoElement.duration;\n      }\n    }\n\n    /**\r\n     * Seeking to live edge, calculated according hls configuration - liveSyncDuration or liveSyncDurationCount.\r\n     * @function seekToLiveEdge\r\n     * @returns {void}\r\n     * @public\r\n     */\n\n  }, {\n    key: 'seekToLiveEdge',\n    value: function seekToLiveEdge() {\n      try {\n        this._videoElement.currentTime = this._getLiveEdge();\n      } catch (e) {\n        return;\n      }\n    }\n\n    /**\r\n     * Checking if the current playback is live.\r\n     * @function isLive\r\n     * @returns {boolean} - Whether playback is live.\r\n     * @public\r\n     */\n\n  }, {\n    key: 'isLive',\n    value: function isLive() {\n      try {\n        return !!this._getLevelDetails().live;\n      } catch (e) {\n        return false;\n      }\n    }\n\n    /**\r\n     * Fired after manifest has been loaded.\r\n     * @function _onManifestLoaded\r\n     * @private\r\n     * @returns {void}\r\n     */\n\n  }, {\n    key: '_onManifestLoaded',\n    value: function _onManifestLoaded() {\n      HlsAdapter._logger.debug('The source has been loaded successfully');\n      if (!this._hls.config.autoStartLoad) {\n        this._hls.startLoad(this._startTime);\n      }\n      this._playerTracks = this._parseTracks();\n    }\n\n    /**\r\n     * Triggers on video track selection (auto or manually) the 'videotrackchanged' event forward.\r\n     * @function _onLevelSwitched\r\n     * @param {string} event - The event name.\r\n     * @param {any} data - The event data object.\r\n     * @private\r\n     * @returns {void}\r\n     */\n\n  }, {\n    key: '_onLevelSwitched',\n    value: function _onLevelSwitched(event, data) {\n      var videoTrack = this._playerTracks.find(function (track) {\n        return track instanceof _pakhshkitJs.VideoTrack && track.index === data.level;\n      });\n      HlsAdapter._logger.debug('Video track changed', videoTrack);\n      this._onTrackChanged(videoTrack);\n    }\n\n    /**\r\n     * Triggers on audio track selection (auto or manually) the 'audiotrackchanged' event forward.\r\n     * @function _onAudioTrackSwitched\r\n     * @param {string} event - The event name.\r\n     * @param {any} data - The event data object.\r\n     * @private\r\n     * @returns {void}\r\n     */\n\n  }, {\n    key: '_onAudioTrackSwitched',\n    value: function _onAudioTrackSwitched(event, data) {\n      var audioTrack = this._playerTracks.find(function (track) {\n        return track instanceof _pakhshkitJs.AudioTrack && track.id === data.id;\n      });\n      HlsAdapter._logger.debug('Audio track changed', audioTrack);\n      this._onTrackChanged(audioTrack);\n      this._handleWaitingUponAudioTrackSwitch();\n    }\n\n    /**\r\n     * Trigger a playing event whenever an audio track is changed & time_update event is fired.\r\n     * This align Edge and IE behaviour to other browsers. When an audio track changed in IE & Edge, they trigger\r\n     * waiting event but not playing event.\r\n     * @returns {void}\r\n     * @private\r\n     */\n\n  }, {\n    key: '_handleWaitingUponAudioTrackSwitch',\n    value: function _handleWaitingUponAudioTrackSwitch() {\n      var _this5 = this;\n\n      var affectedBrowsers = ['IE', 'Edge'];\n      if (affectedBrowsers.includes(_pakhshkitJs.Env.browser.name)) {\n        var timeUpdateListener = function timeUpdateListener() {\n          _this5._trigger(_pakhshkitJs.EventType.PLAYING);\n          _this5._videoElement.removeEventListener(_pakhshkitJs.EventType.TIME_UPDATE, timeUpdateListener);\n        };\n        this._videoElement.addEventListener(_pakhshkitJs.EventType.TIME_UPDATE, timeUpdateListener);\n      }\n    }\n\n    /**\r\n     * Disables all the video tag text tracks.\r\n     * @returns {void}\r\n     * @private\r\n     */\n\n  }, {\n    key: '_disableAllTextTracks',\n    value: function _disableAllTextTracks() {\n      var vidTextTracks = this._videoElement.textTracks;\n      for (var i = 0; i < vidTextTracks.length; i++) {\n        vidTextTracks[i].mode = 'disabled';\n      }\n    }\n\n    /**\r\n     * Handles hls errors.\r\n     * @param {any} data - The event data object.\r\n     * @private\r\n     * @returns {void}\r\n     */\n\n  }, {\n    key: '_onError',\n    value: function _onError(data) {\n      var errorType = data.type;\n      var errorDetails = data.details;\n      var errorFatal = data.fatal;\n      if (errorFatal) {\n        var error = void 0;\n        switch (errorType) {\n          case _hls2.default.ErrorTypes.NETWORK_ERROR:\n            if ([_hls2.default.ErrorDetails.MANIFEST_LOAD_ERROR, _hls2.default.ErrorDetails.MANIFEST_LOAD_TIMEOUT].includes(errorDetails) && !this._triedReloadWithRedirect && !this._config.forceRedirectExternalStreams) {\n              this._reloadWithDirectManifest();\n            } else {\n              error = new _pakhshkitJs.Error(_pakhshkitJs.Error.Severity.CRITICAL, _pakhshkitJs.Error.Category.NETWORK, _pakhshkitJs.Error.Code.HTTP_ERROR, errorDetails);\n            }\n            break;\n          case _hls2.default.ErrorTypes.MEDIA_ERROR:\n            if (this._handleMediaError()) {\n              error = new _pakhshkitJs.Error(_pakhshkitJs.Error.Severity.RECOVERABLE, _pakhshkitJs.Error.Category.MEDIA, _pakhshkitJs.Error.Code.HLS_FATAL_MEDIA_ERROR, errorDetails);\n            } else {\n              error = new _pakhshkitJs.Error(_pakhshkitJs.Error.Severity.CRITICAL, _pakhshkitJs.Error.Category.MEDIA, _pakhshkitJs.Error.Code.HLS_FATAL_MEDIA_ERROR, errorDetails);\n            }\n            break;\n          default:\n            error = new _pakhshkitJs.Error(_pakhshkitJs.Error.Severity.CRITICAL, _pakhshkitJs.Error.Category.PLAYER, _pakhshkitJs.Error.Code.HLS_FATAL_MEDIA_ERROR, errorDetails);\n            break;\n        }\n        this._trigger(_pakhshkitJs.EventType.ERROR, error);\n        if (error && error.severity === _pakhshkitJs.Error.Severity.CRITICAL) {\n          this.destroy();\n        }\n      } else {\n        var _ref = _errors.HlsJsErrorMap[errorDetails] || { category: 0, code: 0 },\n            category = _ref.category,\n            code = _ref.code;\n\n        HlsAdapter._logger.warn(new _pakhshkitJs.Error(_pakhshkitJs.Error.Severity.RECOVERABLE, category, code, errorDetails));\n      }\n    }\n\n    /**\r\n     * Tries to handle media errors via hls.js error handlers\r\n     * @returns {boolean} - if media error is handled or not\r\n     * @private\r\n     */\n\n  }, {\n    key: '_handleMediaError',\n    value: function _handleMediaError() {\n      var now = performance.now();\n      var recover = true;\n      if (this._checkTimeDeltaHasPassed(now, this._recoverDecodingErrorDate, this._config.recoverDecodingErrorDelay)) {\n        this._recoverDecodingError();\n      } else {\n        if (this._checkTimeDeltaHasPassed(now, this._recoverSwapAudioCodecDate, this._config.recoverSwapAudioCodecDelay)) {\n          this._recoverSwapAudioCodec();\n        } else {\n          recover = false;\n          HlsAdapter._logger.error(\"cannot recover, last media error recovery failed\");\n        }\n      }\n      return recover;\n    }\n\n    /**\r\n     * Check if time ahs passed a certain delta\r\n     * @param {number} now - current time\r\n     * @param {number} then - previous time\r\n     * @param {number} delay - time delta in ms\r\n     * @returns {boolean} - if time delta has\r\n     * @private\r\n     */\n\n  }, {\n    key: '_checkTimeDeltaHasPassed',\n    value: function _checkTimeDeltaHasPassed(now, then, delay) {\n      return !then || now - then > delay;\n    }\n\n    /**\r\n     * handle recover from decoding error\r\n     * @returns {void}\r\n     * @private\r\n     */\n\n  }, {\n    key: '_recoverDecodingError',\n    value: function _recoverDecodingError() {\n      this._recoverDecodingErrorDate = performance.now();\n      HlsAdapter._logger.warn(\"try to recover media Error\");\n      this._hls.recoverMediaError();\n    }\n\n    /**\r\n     * handle recover from decoding error by swaping audio codec\r\n     * @returns {void}\r\n     * @private\r\n     */\n\n  }, {\n    key: '_recoverSwapAudioCodec',\n    value: function _recoverSwapAudioCodec() {\n      this._recoverSwapAudioCodecDate = performance.now();\n      HlsAdapter._logger.warn(\"try to swap Audio Codec and recover media Error\");\n      this._hls.swapAudioCodec();\n      this._hls.recoverMediaError();\n    }\n\n    /**\r\n     * Removes hls.js bindings.\r\n     * @returns {void}\r\n     * @private\r\n     */\n\n  }, {\n    key: '_removeBindings',\n    value: function _removeBindings() {\n      this._hls.off(_hls2.default.Events.ERROR, this._onError);\n      this._hls.off(_hls2.default.Events.LEVEL_SWITCHED, this._onLevelSwitched);\n      this._hls.off(_hls2.default.Events.AUDIO_TRACK_SWITCHED, this._onAudioTrackSwitched);\n      this._removeLoadedMetadataListener();\n    }\n\n    /**\r\n     * Get the start time of DVR window in live playback in seconds.\r\n     * @returns {Number} - start time of DVR window.\r\n     * @public\r\n     */\n\n  }, {\n    key: 'getStartTimeOfDvrWindow',\n    value: function getStartTimeOfDvrWindow() {\n      if (this.isLive()) {\n        try {\n          var nextLoadLevel = this._hls.levels[this._hls.nextLoadLevel],\n              details = nextLoadLevel.details,\n              fragments = details.fragments,\n              fragLength = fragments.length,\n              start = fragments[0].start + fragments[0].duration,\n              end = fragments[fragLength - 1].start + fragments[fragLength - 1].duration,\n              maxLatency = this._hls.config.liveMaxLatencyDuration !== undefined ? this._hls.config.liveMaxLatencyDuration : this._hls.config.liveMaxLatencyDurationCount * details.targetduration,\n              minPosToSeek = Math.max(start - this._hls.config.maxFragLookUpTolerance, end - maxLatency);\n          return minPosToSeek;\n        } catch (e) {\n          HlsAdapter._logger.debug('Unable obtain the start of DVR window');\n          return 0;\n        }\n      } else {\n        return 0;\n      }\n    }\n  }]);\n\n  return HlsAdapter;\n}(_pakhshkitJs.BaseMediaSourceAdapter);\n\nHlsAdapter.id = 'HlsAdapter';\nHlsAdapter._logger = _pakhshkitJs.BaseMediaSourceAdapter.getLogger(HlsAdapter.id);\nHlsAdapter._hlsMimeTypes = ['application/x-mpegurl', 'application/vnd.apple.mpegurl', 'audio/mpegurl', 'audio/x-mpegurl', 'video/x-mpegurl', 'video/mpegurl', 'application/mpegurl'];\nexports.default = HlsAdapter;\n\n/***/ }),\n/* 4 */\n/***/ (function(module, exports) {\n\nmodule.exports = {\n\t\"recoverDecodingErrorDelay\": 3000,\n\t\"recoverSwapAudioCodecDelay\": 3000,\n\t\"hlsConfig\": {\n\t\t\"fragLoadingMaxRetry\": 4,\n\t\t\"maxMaxBufferLength\": 60\n\t}\n};\n\n/***/ }),\n/* 5 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.HlsJsErrorMap = undefined;\n\nvar _HlsJsErrorMap;\n\nvar _hls = __webpack_require__(1);\n\nvar _hls2 = _interopRequireDefault(_hls);\n\nvar _pakhshkitJs = __webpack_require__(0);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nvar HlsJsErrorMap = (_HlsJsErrorMap = {}, _defineProperty(_HlsJsErrorMap, _hls2.default.ErrorDetails.MANIFEST_LOAD_ERROR, {\n  category: _pakhshkitJs.Error.Category.MANIFEST,\n  code: _pakhshkitJs.Error.Code.HTTP_ERROR\n}), _defineProperty(_HlsJsErrorMap, _hls2.default.ErrorDetails.MANIFEST_LOAD_TIMEOUT, {\n  category: _pakhshkitJs.Error.Category.MANIFEST,\n  code: _pakhshkitJs.Error.Code.TIMEOUT\n}), _defineProperty(_HlsJsErrorMap, _hls2.default.ErrorDetails.MANIFEST_PARSING_ERROR, {\n  category: _pakhshkitJs.Error.Category.MANIFEST,\n  code: _pakhshkitJs.Error.Code.HLSJS_CANNOT_PARSE\n}), _defineProperty(_HlsJsErrorMap, _hls2.default.ErrorDetails.LEVEL_LOAD_ERROR, {\n  category: _pakhshkitJs.Error.Category.NETWORK,\n  code: _pakhshkitJs.Error.Code.HTTP_ERROR\n}), _defineProperty(_HlsJsErrorMap, _hls2.default.ErrorDetails.LEVEL_LOAD_TIMEOUT, {\n  category: _pakhshkitJs.Error.Category.NETWORK,\n  code: _pakhshkitJs.Error.Code.TIMEOUT\n}), _defineProperty(_HlsJsErrorMap, _hls2.default.ErrorDetails.LEVEL_SWITCH_ERROR, {\n  category: _pakhshkitJs.Error.Category.PLAYER,\n  code: _pakhshkitJs.Error.Code.BITRATE_SWITCH_ISSUE\n}), _defineProperty(_HlsJsErrorMap, _hls2.default.ErrorDetails.FRAG_LOAD_ERROR, {\n  category: _pakhshkitJs.Error.Category.NETWORK,\n  code: _pakhshkitJs.Error.Code.HTTP_ERROR\n}), _defineProperty(_HlsJsErrorMap, _hls2.default.ErrorDetails.FRAG_LOOP_LOADING_ERROR, {\n  category: _pakhshkitJs.Error.Category.NETWORK,\n  code: _pakhshkitJs.Error.Code.HTTP_ERROR\n}), _defineProperty(_HlsJsErrorMap, _hls2.default.ErrorDetails.FRAG_LOAD_TIMEOUT, {\n  category: _pakhshkitJs.Error.Category.NETWORK,\n  code: _pakhshkitJs.Error.Code.TIMEOUT\n}), _defineProperty(_HlsJsErrorMap, _hls2.default.ErrorDetails.FRAG_PARSING_ERROR, {\n  category: _pakhshkitJs.Error.Category.MEDIA,\n  code: _pakhshkitJs.Error.Code.HLS_FRAG_PARSING_ERROR\n}), _defineProperty(_HlsJsErrorMap, _hls2.default.ErrorDetails.BUFFER_APPEND_ERROR, {\n  category: _pakhshkitJs.Error.Category.MEDIA,\n  code: _pakhshkitJs.Error.Code.HLS_BUFFER_APPEND_ISSUE\n}), _defineProperty(_HlsJsErrorMap, _hls2.default.ErrorDetails.BUFFER_APPENDING_ERROR, {\n  category: _pakhshkitJs.Error.Category.MEDIA,\n  code: _pakhshkitJs.Error.Code.HLS_BUFFER_APPENDING_ISSUE\n}), _defineProperty(_HlsJsErrorMap, _hls2.default.ErrorDetails.BUFFER_STALLED_ERROR, {\n  category: _pakhshkitJs.Error.Category.MEDIA,\n  code: _pakhshkitJs.Error.Code.HLS_BUFFER_STALLED_ERROR\n}), _HlsJsErrorMap);\n\nexports.HlsJsErrorMap = HlsJsErrorMap;\n\n/***/ }),\n/* 6 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _pakhshkitJs = __webpack_require__(0);\n\nvar _hls = __webpack_require__(1);\n\nvar _hls2 = _interopRequireDefault(_hls);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\n/**\r\n * A plugin override for the loader function in hls.js.\r\n * It checks if it should use jsonp for the manifest first, else - the regular\r\n * loader is called.\r\n */\nvar pLoader = function (_Hlsjs$DefaultConfig$) {\n  _inherits(pLoader, _Hlsjs$DefaultConfig$);\n\n  /**\r\n   * @constructor\r\n   * @param {Object} config - hlsjs config object. it also contains the jsonp callback function\r\n   */\n  function pLoader(config) {\n    _classCallCheck(this, pLoader);\n\n    var _this = _possibleConstructorReturn(this, (pLoader.__proto__ || Object.getPrototypeOf(pLoader)).call(this, config));\n\n    var loadOrig = _this.load.bind(_this);\n    var callback = pLoader.redirectExternalStreamsHandler;\n    _this.load = function (context, config, callbacks) {\n      var url = context.url;\n      if (context.type === 'manifest') {\n        _pakhshkitJs.Utils.Http.jsonp(url, callback, {\n          timeout: pLoader.redirectExternalStreamsTimeout\n        }).then(function (uri) {\n          context.url = uri;\n          loadOrig(context, config, callbacks);\n        }).catch(function () {\n          return loadOrig(context, config, callbacks);\n        });\n      } else {\n        loadOrig(context, config, callbacks);\n      }\n    };\n    return _this;\n  }\n  /**\r\n   * redirect external stream handler function\r\n   * @param {string} uri - the original uri\r\n   * @returns {string} uri - the redirected URI\r\n   * @static\r\n   */\n\n\n  return pLoader;\n}(_hls2.default.DefaultConfig.loader);\n\npLoader.redirectExternalStreamsHandler = function (uri) {\n  return uri;\n};\n\nexports.default = pLoader;\n\n/***/ })\n/******/ ]);\n});\n\n\n// WEBPACK FOOTER //\n// pakhshkit-hls.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 2);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 12f2222cf2f47807dfac","module.exports = __WEBPACK_EXTERNAL_MODULE_0__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external {\"commonjs\":\"pakhshkit-js\",\"commonjs2\":\"pakhshkit-js\",\"amd\":\"pakhshkit-js\",\"root\":[\"pakhshkit\",\"core\"]}\n// module id = 0\n// module chunks = 0","module.exports = __WEBPACK_EXTERNAL_MODULE_1__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external {\"commonjs\":\"hls.js\",\"commonjs2\":\"hls.js\",\"amd\":\"hls.js\",\"root\":\"Hls\"}\n// module id = 1\n// module chunks = 0","// @flow\r\nimport {registerMediaSourceAdapter} from 'pakhshkit-js'\r\nimport HlsAdapter from './hls-adapter'\r\n\r\ndeclare var __VERSION__: string;\r\ndeclare var __NAME__: string;\r\n\r\nexport default HlsAdapter;\r\nexport {__VERSION__ as VERSION, __NAME__ as NAME};\r\n\r\n// Register hls adapter to the media source adapter provider.\r\nif (HlsAdapter.isSupported()) {\r\n  registerMediaSourceAdapter(HlsAdapter);\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./index.js","//@flow\r\nimport Hlsjs from 'hls.js'\r\nimport DefaultConfig from './default-config'\r\nimport {type ErrorDetailsType, HlsJsErrorMap} from \"./errors\"\r\nimport {\r\n  AudioTrack,\r\n  BaseMediaSourceAdapter,\r\n  Env,\r\n  Error,\r\n  EventType,\r\n  TextTrack,\r\n  Track,\r\n  Utils,\r\n  VideoTrack\r\n} from 'pakhshkit-js'\r\nimport pLoader from './jsonp-ploader'\r\n\r\n/**\r\n * Adapter of hls.js lib for hls content.\r\n * @classdesc\r\n */\r\nexport default class HlsAdapter extends BaseMediaSourceAdapter {\r\n  /**\r\n   * The id of the adapter.\r\n   * @member {string} id\r\n   * @static\r\n   * @private\r\n   */\r\n  static id: string = 'HlsAdapter';\r\n  /**\r\n   * The adapter logger.\r\n   * @member {any} _logger\r\n   * @static\r\n   * @private\r\n   */\r\n  static _logger = BaseMediaSourceAdapter.getLogger(HlsAdapter.id);\r\n  /**\r\n   * The supported mime types by the hls adapter.\r\n   * @member {Array<string>} _hlsMimeType\r\n   * @static\r\n   * @private\r\n   */\r\n  static _hlsMimeTypes: Array<string> = [\r\n    'application/x-mpegurl',\r\n    'application/vnd.apple.mpegurl',\r\n    'audio/mpegurl',\r\n    'audio/x-mpegurl',\r\n    'video/x-mpegurl',\r\n    'video/mpegurl',\r\n    'application/mpegurl'\r\n  ];\r\n  /**\r\n   * The hls player instance.\r\n   * @member {any} _hls\r\n   * @private\r\n   */\r\n  _hls: any;\r\n\r\n  /**\r\n   * last recover date from decoding error\r\n   * @type {number}\r\n   * @private\r\n   */\r\n  _recoverDecodingErrorDate: number;\r\n\r\n  /**\r\n   * last recover date from audio swap codec operation\r\n   * @type {number}\r\n   * @private\r\n   */\r\n  _recoverSwapAudioCodecDate: number;\r\n\r\n  /**\r\n   * indicate if external redirect was performed\r\n   * @type {boolean}\r\n   * @private\r\n   */\r\n  _triedReloadWithRedirect: boolean = false;\r\n\r\n  /**\r\n   * The load promise\r\n   * @member {Promise<Object>} - _loadPromise\r\n   * @type {Promise<Object>}\r\n   * @private\r\n   */\r\n  _loadPromise: ?Promise<Object>;\r\n\r\n  /**\r\n   * Reference to the player tracks.\r\n   * @member {Array<Track>} - _playerTracks\r\n   * @type {Array<Track>}\r\n   * @private\r\n   */\r\n  _playerTracks: Array<Track>;\r\n  /**\r\n   * stream start time in seconds\r\n   * @type {?number}\r\n   * @private\r\n   */\r\n  _startTime: ?number = 0;\r\n  /**\r\n   * Reference to _onLoadedMetadata function\r\n   * @member {?Function} - _onLoadedMetadataCallback\r\n   * @type {?Function}\r\n   * @private\r\n   */\r\n  _onLoadedMetadataCallback: ?Function;\r\n\r\n  /**\r\n   * Factory method to create media source adapter.\r\n   * @function createAdapter\r\n   * @param {HTMLVideoElement} videoElement - The video element that the media source adapter work with.\r\n   * @param {PKMediaSourceObject} source - The source Object.\r\n   * @param {Object} config - The player configuration.\r\n   * @returns {IMediaSourceAdapter} - New instance of the run time media source adapter.\r\n   * @static\r\n   */\r\n  static createAdapter(videoElement: HTMLVideoElement, source: PKMediaSourceObject, config: Object): IMediaSourceAdapter {\r\n    let adapterConfig = {};\r\n    if (Utils.Object.hasPropertyPath(config, 'playback.options.html5.hls')) {\r\n      adapterConfig.hlsConfig = config.playback.options.html5.hls;\r\n    }\r\n    if (Utils.Object.hasPropertyPath(config, 'sources.options')) {\r\n      const options = config.sources.options;\r\n      adapterConfig.forceRedirectExternalStreams = options.forceRedirectExternalStreams;\r\n      adapterConfig.redirectExternalStreamsHandler = options.redirectExternalStreamsHandler;\r\n      adapterConfig.redirectExternalStreamsTimeout = options.redirectExternalStreamsTimeout;\r\n      pLoader.redirectExternalStreamsHandler = adapterConfig.redirectExternalStreamsHandler;\r\n      pLoader.redirectExternalStreamsTimeout = adapterConfig.redirectExternalStreamsTimeout;\r\n    }\r\n    if (Utils.Object.hasPropertyPath(config, 'playback.startTime')) {\r\n      const startTime = Utils.Object.getPropertyPath(config, 'playback.startTime');\r\n      if (startTime > -1) {\r\n        adapterConfig.hlsConfig.startPosition = config.playback.startTime;\r\n      }\r\n    }\r\n    return new this(videoElement, source, adapterConfig);\r\n  }\r\n\r\n  /**\r\n   * Checks if hls adapter can play a given mime type.\r\n   * @function canPlayType\r\n   * @param {string} mimeType - The mime type to check.\r\n   * @returns {boolean} - Whether the hls adapter can play a specific mime type.\r\n   * @static\r\n   */\r\n  static canPlayType(mimeType: string): boolean {\r\n    let canHlsPlayType = (typeof mimeType === 'string') ? HlsAdapter._hlsMimeTypes.includes(mimeType.toLowerCase()) : false;\r\n    HlsAdapter._logger.debug('canPlayType result for mimeType:' + mimeType + ' is ' + canHlsPlayType.toString());\r\n    return canHlsPlayType;\r\n  }\r\n\r\n  /**\r\n   * Checks if hls adapter can play a given drm data.\r\n   * For hls.js it always returns false.\r\n   * @returns {boolean} - Whether the hls adapter can play a specific drm data.\r\n   * @static\r\n   */\r\n  static canPlayDrm(): boolean {\r\n    HlsAdapter._logger.warn('canPlayDrm result is false');\r\n    return false;\r\n  }\r\n\r\n  /**\r\n   * Checks if the hls adapter is supported.\r\n   * @function isSupported\r\n   * @returns {boolean} - Whether hls is supported.\r\n   * @static\r\n   */\r\n  static isSupported(): boolean {\r\n    let isHlsSupported = Hlsjs.isSupported();\r\n    HlsAdapter._logger.debug('isSupported:' + isHlsSupported);\r\n    return isHlsSupported;\r\n  }\r\n\r\n  /**\r\n   * @constructor\r\n   * @param {HTMLVideoElement} videoElement - The video element which will bind to the hls adapter\r\n   * @param {PKMediaSourceObject} source - The source object\r\n   * @param {Object} config - The media source adapter configuration\r\n   */\r\n  constructor(videoElement: HTMLVideoElement, source: PKMediaSourceObject, config: Object) {\r\n    HlsAdapter._logger.debug('Creating adapter. Hls version: ' + Hlsjs.version);\r\n    super(videoElement, source, config);\r\n    this._config = Utils.Object.mergeDeep({}, this._config, DefaultConfig);\r\n    if (this._config.forceRedirectExternalStreams) {\r\n      this._config.hlsConfig['pLoader'] = pLoader;\r\n    }\r\n    this._hls = new Hlsjs(this._config.hlsConfig);\r\n    this._addBindings();\r\n  }\r\n\r\n  /**\r\n   * Adds the required bindings with hls.js.\r\n   * @function _addBindings\r\n   * @private\r\n   * @returns {void}\r\n   */\r\n  _addBindings(): void {\r\n    this._hls.on(Hlsjs.Events.ERROR, (e, data) => this._onError(data));\r\n    this._hls.on(Hlsjs.Events.MANIFEST_LOADED, this._onManifestLoaded.bind(this));\r\n    this._hls.on(Hlsjs.Events.LEVEL_SWITCHED, this._onLevelSwitched.bind(this));\r\n    this._hls.on(Hlsjs.Events.AUDIO_TRACK_SWITCHED, this._onAudioTrackSwitched.bind(this));\r\n  }\r\n\r\n  /**\r\n   * Load the video source\r\n   * @function load\r\n   * @param {number} startTime - Optional time to start the video from.\r\n   * @returns {Promise<Object>} - The loaded data\r\n   * @override\r\n   */\r\n  load(startTime: ?number): Promise<Object> {\r\n    if (!this._loadPromise) {\r\n      this._startTime = startTime;\r\n      this._loadPromise = new Promise((resolve) => {\r\n        this._resolveLoad = resolve;\r\n        this._loadInternal();\r\n      });\r\n    }\r\n    return this._loadPromise;\r\n  }\r\n\r\n  /**\r\n   * Load the video source\r\n   * @function load\r\n   * @returns {void}\r\n   * @private\r\n   */\r\n  _loadInternal() {\r\n    this._onLoadedMetadataCallback = this._onLoadedMetadata.bind(this);\r\n    this._videoElement.addEventListener(EventType.LOADED_METADATA, this._onLoadedMetadataCallback);\r\n    if (this._sourceObj && this._sourceObj.url) {\r\n      this._hls.loadSource(this._sourceObj.url);\r\n      this._hls.attachMedia(this._videoElement);\r\n      this._trigger(EventType.ABR_MODE_CHANGED, {mode: this.isAdaptiveBitrateEnabled() ? 'auto' : 'manual'});\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Load the video source with installed playlist loader\r\n   * @function _reloadWithDirectManifest\r\n   * @returns {void}\r\n   * @private\r\n   */\r\n  _reloadWithDirectManifest() {\r\n    // Mark that we tried once to redirect\r\n    this._triedReloadWithRedirect = true;\r\n    // reset hls.js\r\n    this._reset();\r\n    // re-init hls.js with the external redirect playlist loader\r\n    this._config.hlsConfig['pLoader'] = pLoader;\r\n    this._hls = new Hlsjs(this._config.hlsConfig);\r\n    this._addBindings();\r\n    this._loadInternal();\r\n  }\r\n\r\n  /**\r\n   * Loaded metadata event handler.\r\n   * @private\r\n   * @returns {void}\r\n   */\r\n  _onLoadedMetadata(): void {\r\n    this._removeLoadedMetadataListener();\r\n    this._resolveLoad({tracks: this._playerTracks});\r\n  }\r\n\r\n  /**\r\n   * Remove the loadedmetadata listener\r\n   * @private\r\n   * @returns {void}\r\n   */\r\n  _removeLoadedMetadataListener(): void {\r\n    if (this._onLoadedMetadataCallback) {\r\n      this._videoElement.removeEventListener(EventType.LOADED_METADATA, this._onLoadedMetadataCallback);\r\n      this._onLoadedMetadataCallback = null;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Destroys the hls adapter.\r\n   * @function destroy\r\n   * @override\r\n   * @returns {Promise<*>} - The destroy promise.\r\n   */\r\n  destroy(): Promise<*> {\r\n    return super.destroy().then(() => {\r\n      HlsAdapter._logger.debug('destroy');\r\n      this._loadPromise = null;\r\n      this._playerTracks = [];\r\n      this._reset();\r\n    });\r\n  }\r\n\r\n  /**\r\n   * reset hls.js instance and its bindings\r\n   * @private\r\n   * @returns {void}\r\n   */\r\n  _reset(): void {\r\n    this._removeBindings();\r\n    this._hls.detachMedia();\r\n    this._hls.destroy();\r\n  }\r\n\r\n  /**\r\n   * Parse the hls tracks into player tracks.\r\n   * @returns {Array<Track>} - The parsed tracks.\r\n   * @private\r\n   */\r\n  _parseTracks(): Array<Track> {\r\n    const audioTracks = this._parseAudioTracks(this._hls.audioTracks || []);\r\n    const videoTracks = this._parseVideoTracks(this._hls.levels || []);\r\n    const textTracks = this._parseTextTracks(this._hls.subtitleTracks || []);\r\n    return audioTracks.concat(videoTracks).concat(textTracks);\r\n  }\r\n\r\n  /**\r\n   * Parse hls audio tracks into player audio tracks.\r\n   * @param {Array<Object>} hlsAudioTracks - The hls audio tracks.\r\n   * @returns {Array<AudioTrack>} - The parsed audio tracks.\r\n   * @private\r\n   */\r\n  _parseAudioTracks(hlsAudioTracks: Array<Object>): Array<AudioTrack> {\r\n    let audioTracks = [];\r\n    for (let i = 0; i < hlsAudioTracks.length; i++) {\r\n      // Create audio tracks\r\n      let settings = {\r\n        id: hlsAudioTracks[i].id,\r\n        active: this._hls.audioTrack === hlsAudioTracks[i].id,\r\n        label: hlsAudioTracks[i].name,\r\n        language: hlsAudioTracks[i].lang,\r\n        index: i\r\n      };\r\n      audioTracks.push(new AudioTrack(settings));\r\n    }\r\n    return audioTracks;\r\n  }\r\n\r\n  /**\r\n   * Parse hls video tracks into player video tracks.\r\n   * @param {Array<Object>} hlsVideoTracks - The hls video tracks.\r\n   * @returns {Array<VideoTrack>} - The parsed video tracks.\r\n   * @private\r\n   */\r\n  _parseVideoTracks(hlsVideoTracks: Array<Object>): Array<VideoTrack> {\r\n    let videoTracks = [];\r\n    for (let i = 0; i < hlsVideoTracks.length; i++) {\r\n      // Create video tracks\r\n      let settings = {\r\n        active: this._hls.startLevel === i,\r\n        bandwidth: hlsVideoTracks[i].bitrate,\r\n        width: hlsVideoTracks[i].width,\r\n        height: hlsVideoTracks[i].height,\r\n        language: '',\r\n        index: i\r\n      };\r\n      videoTracks.push(new VideoTrack(settings));\r\n    }\r\n    return videoTracks;\r\n  }\r\n\r\n  /**\r\n   * Parse hls text tracks into player text tracks.\r\n   * @param {Array<Object>} hlsTextTracks - The hls text tracks.\r\n   * @returns {Array<TextTrack>} - The parsed text tracks.\r\n   * @private\r\n   */\r\n  _parseTextTracks(hlsTextTracks: Array<Object>): Array<TextTrack> {\r\n    let textTracks = [];\r\n    for (let i = 0; i < hlsTextTracks.length; i++) {\r\n      // Create text tracks\r\n      let settings = {\r\n        id: hlsTextTracks[i].id,\r\n        active: hlsTextTracks[i].default,\r\n        label: hlsTextTracks[i].name,\r\n        kind: hlsTextTracks[i].type.toLowerCase(),\r\n        language: hlsTextTracks[i].lang,\r\n        index: i\r\n      };\r\n      textTracks.push(new TextTrack(settings));\r\n    }\r\n    return textTracks;\r\n  }\r\n\r\n  /**\r\n   * Select an audio track.\r\n   * @function selectAudioTrack\r\n   * @param {AudioTrack} audioTrack - the audio track to select.\r\n   * @returns {void}\r\n   * @public\r\n   */\r\n  selectAudioTrack(audioTrack: AudioTrack): void {\r\n    if (audioTrack instanceof AudioTrack && !audioTrack.active && this._hls.audioTracks) {\r\n      this._hls.audioTrack = audioTrack.id;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Select a video track.\r\n   * @function selectVideoTrack\r\n   * @param {VideoTrack} videoTrack - the track to select.\r\n   * @returns {void}\r\n   * @public\r\n   */\r\n  selectVideoTrack(videoTrack: VideoTrack): void {\r\n    if (videoTrack instanceof VideoTrack && (!videoTrack.active || this.isAdaptiveBitrateEnabled()) && this._hls.levels) {\r\n      if (this.isAdaptiveBitrateEnabled()) {\r\n        this._trigger(EventType.ABR_MODE_CHANGED, {mode: 'manual'});\r\n      }\r\n      this._hls.currentLevel = videoTrack.index;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Select a text track.\r\n   * @function selectTextTrack\r\n   * @param {TextTrack} textTrack - the track to select.\r\n   * @returns {void}\r\n   * @public\r\n   */\r\n  selectTextTrack(textTrack: TextTrack): void {\r\n    if (textTrack instanceof TextTrack && !textTrack.active && this._videoElement.textTracks) {\r\n      this._disableAllTextTracks();\r\n      this._videoElement.textTracks[textTrack.index].mode = 'hidden';\r\n      HlsAdapter._logger.debug('Text track changed', textTrack);\r\n      this._onTrackChanged(textTrack);\r\n    }\r\n  }\r\n\r\n  /** Hide the text track\r\n   * @function hideTextTrack\r\n   * @returns {void}\r\n   * @public\r\n   */\r\n  hideTextTrack(): void {\r\n    this._disableAllTextTracks();\r\n  }\r\n\r\n  /**\r\n   * Enables adaptive bitrate switching according to hls.js logic.\r\n   * @function enableAdaptiveBitrate\r\n   * @returns {void}\r\n   * @public\r\n   */\r\n  enableAdaptiveBitrate(): void {\r\n    if (!this.isAdaptiveBitrateEnabled()) {\r\n      this._trigger(EventType.ABR_MODE_CHANGED, {mode: 'auto'});\r\n      this._hls.nextLevel = -1;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Checking if adaptive bitrate switching is enabled.\r\n   * @function isAdaptiveBitrateEnabled\r\n   * @returns {boolean} - Whether adaptive bitrate is enabled.\r\n   * @public\r\n   */\r\n  isAdaptiveBitrateEnabled(): boolean {\r\n    return this._hls.autoLevelEnabled;\r\n  }\r\n\r\n  /**\r\n   * Returns the details of hls level\r\n   * @function _getLevelDetails\r\n   * @returns {Object} - Level details\r\n   * @private\r\n   */\r\n  _getLevelDetails(): Object {\r\n    const level = this._hls.levels[this._hls.currentLevel] || this._hls.levels[this._hls.nextLevel] || this._hls.levels[this._hls.nextAutoLevel] || this._hls.levels[this._hls.nextLoadLevel];\r\n    return level && level.details ? level.details : {};\r\n  }\r\n\r\n  /**\r\n   * Returns the live edge\r\n   * @returns {number} - live edge\r\n   * @private\r\n   */\r\n  _getLiveEdge(): number {\r\n    try {\r\n      let liveEdge;\r\n      if (this._hls.liveSyncPosition) {\r\n        liveEdge = this._hls.liveSyncPosition;\r\n      } else if (this._hls.config.liveSyncDuration) {\r\n        liveEdge = this._videoElement.duration - this._hls.config.liveSyncDuration;\r\n      } else {\r\n        liveEdge = this._videoElement.duration - this._hls.config.liveSyncDurationCount * this._getLevelDetails().targetduration;\r\n      }\r\n      return liveEdge > 0 ? liveEdge : this._videoElement.duration;\r\n    } catch (e) {\r\n      HlsAdapter._logger.debug('Live edge calculation failed, fall back to duration');\r\n      return this._videoElement.duration;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Seeking to live edge, calculated according hls configuration - liveSyncDuration or liveSyncDurationCount.\r\n   * @function seekToLiveEdge\r\n   * @returns {void}\r\n   * @public\r\n   */\r\n  seekToLiveEdge(): void {\r\n    try {\r\n      this._videoElement.currentTime = this._getLiveEdge();\r\n    } catch (e) {\r\n      return;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Checking if the current playback is live.\r\n   * @function isLive\r\n   * @returns {boolean} - Whether playback is live.\r\n   * @public\r\n   */\r\n  isLive(): boolean {\r\n    try {\r\n      return !!(this._getLevelDetails().live);\r\n    } catch (e) {\r\n      return false;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Fired after manifest has been loaded.\r\n   * @function _onManifestLoaded\r\n   * @private\r\n   * @returns {void}\r\n   */\r\n  _onManifestLoaded(): void {\r\n    HlsAdapter._logger.debug('The source has been loaded successfully');\r\n    if (!this._hls.config.autoStartLoad) {\r\n      this._hls.startLoad(this._startTime);\r\n    }\r\n    this._playerTracks = this._parseTracks();\r\n  }\r\n\r\n  /**\r\n   * Triggers on video track selection (auto or manually) the 'videotrackchanged' event forward.\r\n   * @function _onLevelSwitched\r\n   * @param {string} event - The event name.\r\n   * @param {any} data - The event data object.\r\n   * @private\r\n   * @returns {void}\r\n   */\r\n  _onLevelSwitched(event: string, data: any): void {\r\n    let videoTrack = this._playerTracks.find((track) => {\r\n      return (track instanceof VideoTrack && track.index === data.level);\r\n    });\r\n    HlsAdapter._logger.debug('Video track changed', videoTrack);\r\n    this._onTrackChanged(videoTrack);\r\n  }\r\n\r\n  /**\r\n   * Triggers on audio track selection (auto or manually) the 'audiotrackchanged' event forward.\r\n   * @function _onAudioTrackSwitched\r\n   * @param {string} event - The event name.\r\n   * @param {any} data - The event data object.\r\n   * @private\r\n   * @returns {void}\r\n   */\r\n  _onAudioTrackSwitched(event: string, data: any): void {\r\n    let audioTrack = this._playerTracks.find((track) => {\r\n      return (track instanceof AudioTrack && track.id === data.id);\r\n    });\r\n    HlsAdapter._logger.debug('Audio track changed', audioTrack);\r\n    this._onTrackChanged(audioTrack);\r\n    this._handleWaitingUponAudioTrackSwitch();\r\n  }\r\n\r\n  /**\r\n   * Trigger a playing event whenever an audio track is changed & time_update event is fired.\r\n   * This align Edge and IE behaviour to other browsers. When an audio track changed in IE & Edge, they trigger\r\n   * waiting event but not playing event.\r\n   * @returns {void}\r\n   * @private\r\n   */\r\n  _handleWaitingUponAudioTrackSwitch(): void {\r\n    const affectedBrowsers = ['IE', 'Edge'];\r\n    if (affectedBrowsers.includes(Env.browser.name)) {\r\n      const timeUpdateListener = () => {\r\n        this._trigger(EventType.PLAYING);\r\n        this._videoElement.removeEventListener(EventType.TIME_UPDATE, timeUpdateListener);\r\n      };\r\n      this._videoElement.addEventListener(EventType.TIME_UPDATE, timeUpdateListener)\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Disables all the video tag text tracks.\r\n   * @returns {void}\r\n   * @private\r\n   */\r\n  _disableAllTextTracks() {\r\n    let vidTextTracks = this._videoElement.textTracks;\r\n    for (let i = 0; i < vidTextTracks.length; i++) {\r\n      vidTextTracks[i].mode = 'disabled';\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Handles hls errors.\r\n   * @param {any} data - The event data object.\r\n   * @private\r\n   * @returns {void}\r\n   */\r\n  _onError(data: any): void {\r\n    const errorType = data.type;\r\n    const errorDetails = data.details;\r\n    const errorFatal = data.fatal;\r\n    if (errorFatal) {\r\n      let error: typeof Error;\r\n      switch (errorType) {\r\n        case Hlsjs.ErrorTypes.NETWORK_ERROR:\r\n          if ([Hlsjs.ErrorDetails.MANIFEST_LOAD_ERROR, Hlsjs.ErrorDetails.MANIFEST_LOAD_TIMEOUT].includes(errorDetails) &&\r\n            !this._triedReloadWithRedirect && !this._config.forceRedirectExternalStreams) {\r\n            this._reloadWithDirectManifest();\r\n          } else {\r\n            error = new Error(\r\n              Error.Severity.CRITICAL,\r\n              Error.Category.NETWORK,\r\n              Error.Code.HTTP_ERROR,\r\n              errorDetails);\r\n          }\r\n          break;\r\n        case Hlsjs.ErrorTypes.MEDIA_ERROR:\r\n          if (this._handleMediaError()) {\r\n            error = new Error(\r\n              Error.Severity.RECOVERABLE,\r\n              Error.Category.MEDIA,\r\n              Error.Code.HLS_FATAL_MEDIA_ERROR,\r\n              errorDetails);\r\n          } else {\r\n            error = new Error(\r\n              Error.Severity.CRITICAL,\r\n              Error.Category.MEDIA,\r\n              Error.Code.HLS_FATAL_MEDIA_ERROR,\r\n              errorDetails);\r\n          }\r\n          break;\r\n        default:\r\n          error = new Error(\r\n            Error.Severity.CRITICAL,\r\n            Error.Category.PLAYER,\r\n            Error.Code.HLS_FATAL_MEDIA_ERROR,\r\n            errorDetails);\r\n          break;\r\n      }\r\n      this._trigger(EventType.ERROR, error);\r\n      if (error && error.severity === Error.Severity.CRITICAL) {\r\n        this.destroy();\r\n      }\r\n    } else {\r\n      const {category, code}: ErrorDetailsType = HlsJsErrorMap[errorDetails] || {category: 0, code: 0};\r\n      HlsAdapter._logger.warn(new Error(\r\n        Error.Severity.RECOVERABLE,\r\n        category,\r\n        code,\r\n        errorDetails));\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Tries to handle media errors via hls.js error handlers\r\n   * @returns {boolean} - if media error is handled or not\r\n   * @private\r\n   */\r\n  _handleMediaError(): boolean {\r\n    const now: number = performance.now();\r\n    let recover = true;\r\n    if (this._checkTimeDeltaHasPassed(now, this._recoverDecodingErrorDate, this._config.recoverDecodingErrorDelay)) {\r\n      this._recoverDecodingError();\r\n    } else {\r\n      if (this._checkTimeDeltaHasPassed(now, this._recoverSwapAudioCodecDate, this._config.recoverSwapAudioCodecDelay)) {\r\n        this._recoverSwapAudioCodec();\r\n      } else {\r\n        recover = false;\r\n        HlsAdapter._logger.error(\"cannot recover, last media error recovery failed\");\r\n      }\r\n    }\r\n    return recover;\r\n  }\r\n\r\n  /**\r\n   * Check if time ahs passed a certain delta\r\n   * @param {number} now - current time\r\n   * @param {number} then - previous time\r\n   * @param {number} delay - time delta in ms\r\n   * @returns {boolean} - if time delta has\r\n   * @private\r\n   */\r\n  _checkTimeDeltaHasPassed(now: number, then: number, delay: number): boolean {\r\n    return (!then || (now - then) > delay);\r\n  }\r\n\r\n  /**\r\n   * handle recover from decoding error\r\n   * @returns {void}\r\n   * @private\r\n   */\r\n  _recoverDecodingError(): void {\r\n    this._recoverDecodingErrorDate = performance.now();\r\n    HlsAdapter._logger.warn(\"try to recover media Error\");\r\n    this._hls.recoverMediaError();\r\n  }\r\n\r\n  /**\r\n   * handle recover from decoding error by swaping audio codec\r\n   * @returns {void}\r\n   * @private\r\n   */\r\n  _recoverSwapAudioCodec(): void {\r\n    this._recoverSwapAudioCodecDate = performance.now();\r\n    HlsAdapter._logger.warn(\"try to swap Audio Codec and recover media Error\");\r\n    this._hls.swapAudioCodec();\r\n    this._hls.recoverMediaError();\r\n  }\r\n\r\n  /**\r\n   * Removes hls.js bindings.\r\n   * @returns {void}\r\n   * @private\r\n   */\r\n  _removeBindings(): void {\r\n    this._hls.off(Hlsjs.Events.ERROR, this._onError);\r\n    this._hls.off(Hlsjs.Events.LEVEL_SWITCHED, this._onLevelSwitched);\r\n    this._hls.off(Hlsjs.Events.AUDIO_TRACK_SWITCHED, this._onAudioTrackSwitched);\r\n    this._removeLoadedMetadataListener();\r\n  }\r\n\r\n  /**\r\n   * Get the start time of DVR window in live playback in seconds.\r\n   * @returns {Number} - start time of DVR window.\r\n   * @public\r\n   */\r\n  getStartTimeOfDvrWindow(): number {\r\n    if (this.isLive()) {\r\n      try {\r\n        const nextLoadLevel = this._hls.levels[this._hls.nextLoadLevel],\r\n          details = nextLoadLevel.details,\r\n          fragments = details.fragments,\r\n          fragLength = fragments.length,\r\n          start = fragments[0].start + fragments[0].duration,\r\n          end = fragments[fragLength - 1].start + fragments[fragLength - 1].duration,\r\n          maxLatency = this._hls.config.liveMaxLatencyDuration !== undefined ? this._hls.config.liveMaxLatencyDuration : this._hls.config.liveMaxLatencyDurationCount * details.targetduration,\r\n          minPosToSeek = Math.max(start - this._hls.config.maxFragLookUpTolerance, end - maxLatency);\r\n        return minPosToSeek;\r\n      }\r\n      catch (e) {\r\n        HlsAdapter._logger.debug('Unable obtain the start of DVR window');\r\n        return 0;\r\n      }\r\n    } else {\r\n      return 0;\r\n    }\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./hls-adapter.js","module.exports = {\n\t\"recoverDecodingErrorDelay\": 3000,\n\t\"recoverSwapAudioCodecDelay\": 3000,\n\t\"hlsConfig\": {\n\t\t\"fragLoadingMaxRetry\": 4,\n\t\t\"maxMaxBufferLength\": 60\n\t}\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./default-config.json\n// module id = 4\n// module chunks = 0","// @flow\r\nimport Hlsjs from 'hls.js'\r\nimport {Error} from 'pakhshkit-js'\r\n\r\ntype ErrorDetailsType = {category: number, code: number};\r\ntype HlsJsErrorMapType = {[name: string]: ErrorDetailsType};\r\n\r\nconst HlsJsErrorMap: HlsJsErrorMapType = {\r\n  [Hlsjs.ErrorDetails.MANIFEST_LOAD_ERROR]: {\r\n    category: Error.Category.MANIFEST,\r\n    code: Error.Code.HTTP_ERROR\r\n  },\r\n  [Hlsjs.ErrorDetails.MANIFEST_LOAD_TIMEOUT]: {\r\n    category: Error.Category.MANIFEST,\r\n    code: Error.Code.TIMEOUT\r\n  },\r\n  [Hlsjs.ErrorDetails.MANIFEST_PARSING_ERROR]: {\r\n    category: Error.Category.MANIFEST,\r\n    code: Error.Code.HLSJS_CANNOT_PARSE\r\n  },\r\n  [Hlsjs.ErrorDetails.LEVEL_LOAD_ERROR]: {\r\n    category: Error.Category.NETWORK,\r\n    code: Error.Code.HTTP_ERROR\r\n  },\r\n  [Hlsjs.ErrorDetails.LEVEL_LOAD_TIMEOUT]: {\r\n    category: Error.Category.NETWORK,\r\n    code: Error.Code.TIMEOUT\r\n  },\r\n  [Hlsjs.ErrorDetails.LEVEL_SWITCH_ERROR]: {\r\n    category: Error.Category.PLAYER,\r\n    code: Error.Code.BITRATE_SWITCH_ISSUE\r\n  },\r\n  [Hlsjs.ErrorDetails.FRAG_LOAD_ERROR]: {\r\n    category: Error.Category.NETWORK,\r\n    code: Error.Code.HTTP_ERROR\r\n  },\r\n  [Hlsjs.ErrorDetails.FRAG_LOOP_LOADING_ERROR]: {\r\n    category: Error.Category.NETWORK,\r\n    code: Error.Code.HTTP_ERROR\r\n  },\r\n  [Hlsjs.ErrorDetails.FRAG_LOAD_TIMEOUT]: {\r\n    category: Error.Category.NETWORK,\r\n    code: Error.Code.TIMEOUT\r\n  },\r\n  [Hlsjs.ErrorDetails.FRAG_PARSING_ERROR]: {\r\n    category: Error.Category.MEDIA,\r\n    code: Error.Code.HLS_FRAG_PARSING_ERROR\r\n  },\r\n  [Hlsjs.ErrorDetails.BUFFER_APPEND_ERROR]: {\r\n    category: Error.Category.MEDIA,\r\n    code: Error.Code.HLS_BUFFER_APPEND_ISSUE\r\n  },\r\n  [Hlsjs.ErrorDetails.BUFFER_APPENDING_ERROR]: {\r\n    category: Error.Category.MEDIA,\r\n    code: Error.Code.HLS_BUFFER_APPENDING_ISSUE\r\n  },\r\n  [Hlsjs.ErrorDetails.BUFFER_STALLED_ERROR]: {\r\n    category: Error.Category.MEDIA,\r\n    code: Error.Code.HLS_BUFFER_STALLED_ERROR\r\n  }\r\n};\r\n\r\nexport {HlsJsErrorMap};\r\nexport type {ErrorDetailsType};\r\n\n\n\n// WEBPACK FOOTER //\n// ./errors.js","//@flow\r\nimport {Utils} from 'pakhshkit-js'\r\nimport Hlsjs from 'hls.js'\r\n\r\n/**\r\n * A plugin override for the loader function in hls.js.\r\n * It checks if it should use jsonp for the manifest first, else - the regular\r\n * loader is called.\r\n */\r\nexport default class pLoader extends Hlsjs.DefaultConfig.loader {\r\n  /**\r\n   * redirect external stream handler function\r\n   * @param {string} uri - the original uri\r\n   * @returns {string} uri - the redirected URI\r\n   * @static\r\n   */\r\n  static redirectExternalStreamsHandler: Function = uri => uri;\r\n\r\n  /**\r\n   * @constructor\r\n   * @param {Object} config - hlsjs config object. it also contains the jsonp callback function\r\n   */\r\n  constructor(config: Object) {\r\n    super(config);\r\n    const loadOrig = this.load.bind(this);\r\n    const callback = pLoader.redirectExternalStreamsHandler;\r\n    this.load = (context, config, callbacks) => {\r\n      const url = context.url;\r\n      if (context.type === 'manifest') {\r\n        Utils.Http.jsonp(url, callback, {\r\n          timeout: pLoader.redirectExternalStreamsTimeout\r\n        }).then(uri => {\r\n          context.url = uri;\r\n          loadOrig(context, config, callbacks);\r\n        }).catch(() => loadOrig(context, config, callbacks));\r\n      } else {\r\n        loadOrig(context, config, callbacks);\r\n      }\r\n    };\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./jsonp-ploader.js"],"sourceRoot":""}